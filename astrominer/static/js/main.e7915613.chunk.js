(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{30:function(e,t,n){e.exports=n(62)},35:function(e,t,n){},36:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"distanceBetween",(function(){return _})),n.d(r,"midPoint",(function(){return S})),n.d(r,"normalizeRadian",(function(){return g})),n.d(r,"calcGravity",(function(){return v})),n.d(r,"directionTo",(function(){return A})),n.d(r,"dirComponents",(function(){return T})),n.d(r,"randomInt",(function(){return x})),n.d(r,"randomFloat",(function(){return b})),n.d(r,"randomBool",(function(){return P})),n.d(r,"getPointFrom",(function(){return R})),n.d(r,"getVertexData",(function(){return N})),n.d(r,"toGlobal",(function(){return M})),n.d(r,"pointInSprite",(function(){return L})),n.d(r,"keyboardListener",(function(){return D})),n.d(r,"showToast",(function(){return C}));var a={};n.r(a),n.d(a,"APP_VERSION",(function(){return G})),n.d(a,"BLACK",(function(){return k})),n.d(a,"YELLOW",(function(){return W})),n.d(a,"BLUE",(function(){return B})),n.d(a,"WHITE",(function(){return Y})),n.d(a,"DARKER_GREY",(function(){return q})),n.d(a,"DARK_GREY",(function(){return Q})),n.d(a,"LIGHT_GREY",(function(){return K})),n.d(a,"GREY",(function(){return X})),n.d(a,"RED",(function(){return V})),n.d(a,"GREEN",(function(){return J})),n.d(a,"PURPLE",(function(){return z})),n.d(a,"GAME_STATE",(function(){return Z})),n.d(a,"LOCALSTORAGE_GAME_NAMES_KEY",(function(){return $})),n.d(a,"SCREEN_WIDTH",(function(){return ee})),n.d(a,"SCREEN_HEIGHT",(function(){return te})),n.d(a,"HALF_SCREEN_WIDTH",(function(){return ne})),n.d(a,"HALF_SCREEN_HEIGHT",(function(){return re})),n.d(a,"NEARBY_WIDTH",(function(){return ae})),n.d(a,"NEARBY_HEIGHT",(function(){return ie})),n.d(a,"MINIMAP_WIDTH",(function(){return oe})),n.d(a,"MINIMAP_HEIGHT",(function(){return ue})),n.d(a,"HALF_MINIMAP_WIDTH",(function(){return se})),n.d(a,"HALF_MINIMAP_HEIGHT",(function(){return le})),n.d(a,"MINIMAP_VIEW_WIDTH",(function(){return ce})),n.d(a,"MINIMAP_VIEW_HEIGHT",(function(){return de})),n.d(a,"HALF_MINIMAP_VIEW_WIDTH",(function(){return me})),n.d(a,"HALF_MINIMAP_VIEW_HEIGHT",(function(){return pe})),n.d(a,"MINIMAP_SCALE_X",(function(){return Ee})),n.d(a,"MINIMAP_SCALE_Y",(function(){return fe})),n.d(a,"SPRITESHEET_JSON",(function(){return he})),n.d(a,"ALIEN_SHIP_BLACK_FILE",(function(){return we})),n.d(a,"ALIEN_SHIP_BLUE_FILE",(function(){return ye})),n.d(a,"ALIEN_SHIP_BLUE_LARGE_FILE",(function(){return Ie})),n.d(a,"ALIEN_SHIP_BLUE_SMALL_FILE",(function(){return _e})),n.d(a,"ALIEN_SHIP_FIRE_FILE",(function(){return Se})),n.d(a,"ALIEN_SHIP_GREEN_FILE",(function(){return ge})),n.d(a,"ALIEN_SHIP_GREEN_SMALL_FILE",(function(){return ve})),n.d(a,"ALIEN_SHIP_GREEN_LARGE_FILE",(function(){return Ae})),n.d(a,"ALIEN_SHIP_RED_FILE",(function(){return Te})),n.d(a,"ALIEN_SHIP_RED_SMALL_FILE",(function(){return xe})),n.d(a,"ALIEN_SHIP_RED_LARGE_FILE",(function(){return be})),n.d(a,"BULLET_FILE",(function(){return Pe})),n.d(a,"BULLET_BLUE_FILE",(function(){return Re})),n.d(a,"BULLET_WHITE_FILE",(function(){return Ne})),n.d(a,"FACTORY_FILE",(function(){return Me})),n.d(a,"MINE_FILE",(function(){return Le})),n.d(a,"PLANET_GREEN_FILE",(function(){return Oe})),n.d(a,"PLANET_PURPLE_FILE",(function(){return He})),n.d(a,"PLANET_RED_FILE",(function(){return De})),n.d(a,"PLANET_ROCK_FILE",(function(){return Ce})),n.d(a,"WORMHOLE_SPRITE",(function(){return Fe})),n.d(a,"SHIELD_BLUE_FILE",(function(){return je})),n.d(a,"SHIELD_GREEN_FILE",(function(){return Ue})),n.d(a,"SHIELD_WHITE_FILE",(function(){return Ge})),n.d(a,"SHIP_BALL_FILE",(function(){return ke})),n.d(a,"SHIP_CARGO_FILE",(function(){return We})),n.d(a,"SHIP_EXPLORER_FILE",(function(){return Be})),n.d(a,"SHIP_FAST_FILE",(function(){return Ye})),n.d(a,"SHIP_FIGHTER_FILE",(function(){return qe})),n.d(a,"SHIP_HEAVY_FILE",(function(){return Qe})),n.d(a,"SHIP_MISSILE_FILE",(function(){return Ke})),n.d(a,"SHIP_RED_WINGS_FILE",(function(){return Xe})),n.d(a,"SHIP_SKELETON_FILE",(function(){return Ve})),n.d(a,"STAR_BACKGROUND_FILE",(function(){return Je})),n.d(a,"CRASH_JSON",(function(){return ze})),n.d(a,"CRASH",(function(){return Ze})),n.d(a,"SMOKE_JSON",(function(){return $e})),n.d(a,"SMOKE",(function(){return et})),n.d(a,"UNIVERSE_RADIUS",(function(){return tt})),n.d(a,"OUTER_RING_MIN",(function(){return nt})),n.d(a,"OUTER_RING_MAX",(function(){return rt})),n.d(a,"PLAYER",(function(){return at})),n.d(a,"ALIEN",(function(){return it})),n.d(a,"PLAYER_STARTING_RESOURCES",(function(){return ot})),n.d(a,"GRAVITATIONAL_CONST",(function(){return ut})),n.d(a,"ALLOWED_OVERLAP",(function(){return st})),n.d(a,"TAKEOFF_SPEED",(function(){return lt})),n.d(a,"PLANET_RESOURCE_MAX",(function(){return ct})),n.d(a,"PLAYER_START_X",(function(){return dt})),n.d(a,"PLAYER_START_Y",(function(){return mt})),n.d(a,"MIN_ALIEN_DIST_TO_PLANET",(function(){return pt})),n.d(a,"MIN_ALIEN_DIST_TO_ALIEN",(function(){return Et})),n.d(a,"MINIMAP_BORDER_COLOR",(function(){return ft})),n.d(a,"MINIMAP_BACKGROUND_COLOR",(function(){return ht})),n.d(a,"MINIMAP_BUILDING_COLOR",(function(){return wt})),n.d(a,"MINIMAP_SHIP_COLOR",(function(){return yt})),n.d(a,"MINIMAP_SELECTED_PLANET_COLOR",(function(){return It})),n.d(a,"PLANET_COLORS",(function(){return _t})),n.d(a,"BUILDING_PLACEMENT_ROTATION_INCREMENT",(function(){return St})),n.d(a,"BUILDING_TYPE_MINE",(function(){return gt})),n.d(a,"MINE_SCALE",(function(){return vt})),n.d(a,"MINE_WIDTH",(function(){return At})),n.d(a,"MINE_ANIMATION_SPEED",(function(){return Tt})),n.d(a,"MINE_SPEED_TITANIUM",(function(){return xt})),n.d(a,"MINE_SPEED_GOLD",(function(){return bt})),n.d(a,"MINE_SPEED_URANIUM",(function(){return Pt})),n.d(a,"MINE_COST",(function(){return Rt})),n.d(a,"SALVAGE_RATE",(function(){return Nt})),n.d(a,"BUILDING_TYPE_FACTORY",(function(){return Mt})),n.d(a,"FACTORY_COST",(function(){return Lt})),n.d(a,"FACTORY_WIDTH",(function(){return Ot})),n.d(a,"FACTORY_SCALE",(function(){return Ht})),n.d(a,"EQUIP_TYPE_BRAKE",(function(){return Dt})),n.d(a,"EQUIP_TYPE_PRIMARY_WEAPON",(function(){return Ct})),n.d(a,"EQUIP_TYPE_SECONDARY_WEAPON",(function(){return Ft})),n.d(a,"EQUIP_TYPE_THRUSTER",(function(){return jt})),n.d(a,"EQUIP_TYPE_ARMOR",(function(){return Ut})),n.d(a,"EQUIP_TYPE_REPAIR_DROID",(function(){return Gt})),n.d(a,"EQUIP_TYPE_GUNNERY_DROID",(function(){return kt})),n.d(a,"EQUIP_TYPE_SHIELD_DROID",(function(){return Wt})),n.d(a,"EQUIP_TYPE_SPEED",(function(){return Bt})),n.d(a,"EQUIP_TYPE_TURN",(function(){return Yt})),n.d(a,"EQUIP_TYPE_STORAGE",(function(){return qt})),n.d(a,"EQUIP_TYPE_AUTOLANDER",(function(){return Qt})),n.d(a,"EQUIP_TYPE_GRAVITY_SHIELD",(function(){return Kt})),n.d(a,"THRUST_MOMENTUM",(function(){return Xt})),n.d(a,"THRUST_BLINK",(function(){return Vt})),n.d(a,"OBJ_EQUIP",(function(){return Jt})),n.d(a,"OBJ_SHIP",(function(){return zt})),n.d(a,"ALIEN_AI_TURRET",(function(){return Zt})),n.d(a,"ALIEN_AI_CREEPER",(function(){return $t})),n.d(a,"ALIEN_AI_MOTHERSHIP",(function(){return en})),n.d(a,"ALIEN_AI_KAMIKAZI",(function(){return tn})),n.d(a,"EQUIP_AI_MINE",(function(){return nn})),n.d(a,"EQUIP_AI_TURRET",(function(){return rn})),n.d(a,"EQUIP_AI_MISSILE",(function(){return an})),n.d(a,"EQUIP_AI_RESOURCE_DROID",(function(){return on})),n.d(a,"DIR_AHEAD_OF_SHIP",(function(){return un})),n.d(a,"DIR_BEHIND_SHIP",(function(){return sn})),n.d(a,"EQUIP_BRAKE",(function(){return ln})),n.d(a,"EQUIP_BLINK_BRAKE",(function(){return cn})),n.d(a,"EQUIP_SPEED_BOOST",(function(){return dn})),n.d(a,"EQUIP_TURN_BOOST",(function(){return mn})),n.d(a,"EQUIP_STORAGE",(function(){return pn})),n.d(a,"EQUIP_ENHANCED_STORAGE",(function(){return En})),n.d(a,"EQUIP_ARMOR",(function(){return fn})),n.d(a,"EQUIP_ENHANCED_ARMOR",(function(){return hn})),n.d(a,"EQUIP_THRUSTER",(function(){return wn})),n.d(a,"EQUIP_BLINK_THRUSTER",(function(){return yn})),n.d(a,"EQUIP_AUTOLANDER",(function(){return In})),n.d(a,"EQUIP_GRAVITY_SHIELD",(function(){return _n})),n.d(a,"EQUIP_BLASTER",(function(){return Sn})),n.d(a,"EQUIP_FAST_BLASTER",(function(){return gn})),n.d(a,"EQUIP_SPRINKLER_BLASTER",(function(){return vn})),n.d(a,"EQUIP_STREAM_BLASTER",(function(){return An})),n.d(a,"EQUIP_MELEE_GUN",(function(){return Tn})),n.d(a,"EQUIP_SNIPER_RIFLE",(function(){return xn})),n.d(a,"EQUIP_ALIEN_BLASTER",(function(){return bn})),n.d(a,"EQUIP_ALIEN_BLASTER_FAST",(function(){return Pn})),n.d(a,"EQUIP_ALIEN_BLASTER_LIGHTNING",(function(){return Rn})),n.d(a,"EQUIP_STAPLE_GUN",(function(){return Nn})),n.d(a,"EQUIP_STAPLE_GUN_HEAVY",(function(){return Mn})),n.d(a,"EQUIP_SHIELD",(function(){return Ln})),n.d(a,"EQUIP_SHIELD_WEAK",(function(){return On})),n.d(a,"EQUIP_SHIELD_LONG",(function(){return Hn})),n.d(a,"EQUIP_SHIELD_STRONG",(function(){return Dn})),n.d(a,"EQUIP_SHIELD_ULTRA",(function(){return Cn})),n.d(a,"EQUIP_SHIELD_BLINK",(function(){return Fn})),n.d(a,"SHIP_RED_MISSILE",(function(){return jn})),n.d(a,"EQUIP_ALIEN_MISSILE_LAUNCHER",(function(){return Un})),n.d(a,"EQUIP_R2D2",(function(){return Gn})),n.d(a,"EQUIP_GUNNERY_DROID",(function(){return kn})),n.d(a,"EQUIP_LIGHTING_DROID",(function(){return Wn})),n.d(a,"EQUIP_SHIELD_DROID",(function(){return Bn})),n.d(a,"SHIP_EXPLORER",(function(){return Yn})),n.d(a,"SHIP_CARGO",(function(){return qn})),n.d(a,"SHIP_FAST",(function(){return Qn})),n.d(a,"SHIP_SKELETON",(function(){return Kn})),n.d(a,"SHIP_HEAVY",(function(){return Xn})),n.d(a,"SHIP_FIGHTER",(function(){return Vn})),n.d(a,"SHIP_WING",(function(){return Jn})),n.d(a,"SHIP_ALIEN_TURRET",(function(){return zn})),n.d(a,"SHIP_ALIEN",(function(){return Zn})),n.d(a,"SHIP_ALIEN_LARGE",(function(){return $n})),n.d(a,"SHIP_ALIEN_STAPLE_TURRET",(function(){return er})),n.d(a,"SHIP_ALIEN_LIGHTNING_TURRET",(function(){return tr})),n.d(a,"SHIP_ALIEN_FIRE",(function(){return nr})),n.d(a,"SHIP_ALIEN_STEALTH",(function(){return rr})),n.d(a,"SHIP_ALIEN_MOTHERSHIP",(function(){return ar})),n.d(a,"SHIP_DECOY",(function(){return ir})),n.d(a,"SHIP_TURRET",(function(){return or})),n.d(a,"SHIP_STREAM_TURRET",(function(){return ur})),n.d(a,"SHIP_MISSILE",(function(){return sr})),n.d(a,"SHIP_BOMB",(function(){return lr})),n.d(a,"SHIP_FRIENDSHIP_MISSILE",(function(){return cr})),n.d(a,"SHIP_RESOURCE_DROID",(function(){return dr})),n.d(a,"ALL_ALIENS",(function(){return mr})),n.d(a,"ALL_SHIPS",(function(){return pr})),n.d(a,"EQUIP_DECOY_DEPLOYER",(function(){return Er})),n.d(a,"EQUIP_TURRET_DEPLOYER",(function(){return fr})),n.d(a,"EQUIP_STREAM_TURRET_DEPLOYER",(function(){return hr})),n.d(a,"EQUIP_MISSILE_LAUNCHER",(function(){return wr})),n.d(a,"EQUIP_BOMB_LAUNCHER",(function(){return yr})),n.d(a,"EQUIP_FRIENDSHIP_GUN",(function(){return Ir})),n.d(a,"EQUIP_UPGRADES",(function(){return _r})),n.d(a,"EQUIP_PRIMARY_WEAPONS",(function(){return Sr})),n.d(a,"EQUIP_SECONDARY_WEAPONS",(function(){return gr})),n.d(a,"EQUIP_DROIDS",(function(){return vr})),n.d(a,"ALL_EQUIP",(function(){return Ar})),n.d(a,"XP_LEVELS",(function(){return Tr})),n.d(a,"PLANET_DENSITY",(function(){return xr})),n.d(a,"UNIVERSE_RINGS",(function(){return br}));var i={};n.r(i),n.d(i,"createEmptyWorld",(function(){return Or})),n.d(i,"setupWorld",(function(){return Hr})),n.d(i,"setupSpriteContainers",(function(){return Dr})),n.d(i,"createBackground",(function(){return Cr})),n.d(i,"createPlanets",(function(){return Fr})),n.d(i,"createPlanet",(function(){return kr})),n.d(i,"getPlanetSprite",(function(){return Wr})),n.d(i,"getShipSprite",(function(){return Br})),n.d(i,"getSpriteOrigWithHeight",(function(){return Yr})),n.d(i,"setShieldRadius",(function(){return qr})),n.d(i,"getShieldSprite",(function(){return Qr})),n.d(i,"createShip",(function(){return Kr})),n.d(i,"createAlien",(function(){return Xr})),n.d(i,"createAliens",(function(){return Vr})),n.d(i,"createExtras",(function(){return Jr})),n.d(i,"setupMiniMap",(function(){return zr})),n.d(i,"click",(function(){return Zr})),n.d(i,"changeGameState",(function(){return $r})),n.d(i,"runBuildings",(function(){return ea})),n.d(i,"addAlienXp",(function(){return na})),n.d(i,"addBlueprint",(function(){return ra})),n.d(i,"canAfford",(function(){return aa})),n.d(i,"payResourceCost",(function(){return ia})),n.d(i,"payResource",(function(){return oa})),n.d(i,"setupExplosionSheet",(function(){return ua})),n.d(i,"createExplosionSprite",(function(){return sa}));var o={};n.r(o),n.d(o,"enterFlyState",(function(){return la})),n.d(o,"flyLoop",(function(){return ca})),n.d(o,"setupNearby",(function(){return da})),n.d(o,"repositionScreen",(function(){return ma})),n.d(o,"coolAllWeapons",(function(){return pa})),n.d(o,"coolWeapons",(function(){return Ea})),n.d(o,"resetWeaponsCool",(function(){return fa})),n.d(o,"runDroids",(function(){return ha})),n.d(o,"shootAtNearestAlien",(function(){return wa})),n.d(o,"moveBackground",(function(){return ya})),n.d(o,"planetInView",(function(){return Ia})),n.d(o,"getActiveShield",(function(){return _a})),n.d(o,"getAvailableShieldEquip",(function(){return Sa})),n.d(o,"hasShieldDroid",(function(){return ga})),n.d(o,"getEquippedShield",(function(){return va})),n.d(o,"detectCollisionWithPlanet",(function(){return Aa})),n.d(o,"detectCollisionWithAlien",(function(){return Ta})),n.d(o,"getExplosionSprite",(function(){return ba})),n.d(o,"bigExplosion",(function(){return Pa})),n.d(o,"destroyShip",(function(){return Ra})),n.d(o,"fireWeapon",(function(){return Oa})),n.d(o,"firePrimaryWeapon",(function(){return Ha})),n.d(o,"getSecondaryWeapon",(function(){return Da})),n.d(o,"fireSecondaryWeapon",(function(){return Ca})),n.d(o,"enableShield",(function(){return Fa})),n.d(o,"disableShield",(function(){return ja})),n.d(o,"fireBullet",(function(){return Ua})),n.d(o,"moveBullets",(function(){return ka})),n.d(o,"damageShip",(function(){return Ya})),n.d(o,"shipsCollide",(function(){return qa})),n.d(o,"getEquip",(function(){return Qa})),n.d(o,"drawMiniMap",(function(){return Ka})),n.d(o,"clickOnMinimap",(function(){return Xa})),n.d(o,"weaponRange",(function(){return Ja})),n.d(o,"primaryWeaponRange",(function(){return za}));var u={};n.r(u),n.d(u,"enterManageState",(function(){return Za})),n.d(u,"manageLoop",(function(){return $a})),n.d(u,"takeOff",(function(){return ei})),n.d(u,"makeBuildingSprite",(function(){return ni})),n.d(u,"buildMine",(function(){return ri})),n.d(u,"getBuildingPlacementRotation",(function(){return ai})),n.d(u,"getAvailablePlanetXY",(function(){return ii})),n.d(u,"buildingFits",(function(){return oi})),n.d(u,"transferResource",(function(){return ui})),n.d(u,"unloadShip",(function(){return si})),n.d(u,"resupplyShip",(function(){return li})),n.d(u,"buildFactory",(function(){return ci})),n.d(u,"buildShip",(function(){return di})),n.d(u,"switchToShip",(function(){return mi})),n.d(u,"removeShipFromStorage",(function(){return pi})),n.d(u,"addShipToStorage",(function(){return Ei})),n.d(u,"hasFactory",(function(){return fi})),n.d(u,"makeEquip",(function(){return hi})),n.d(u,"buildEquip",(function(){return wi})),n.d(u,"launchDroidShip",(function(){return yi})),n.d(u,"costToRepair",(function(){return Ii})),n.d(u,"repairShip",(function(){return _i})),n.d(u,"addEquip",(function(){return Si})),n.d(u,"selectFirstSecondaryWeapon",(function(){return gi})),n.d(u,"moveEquipFromPlanetToShip",(function(){return vi})),n.d(u,"moveEquipFromShipToPlanet",(function(){return Ai})),n.d(u,"salvageEquip",(function(){return Ti})),n.d(u,"salvageShip",(function(){return xi})),n.d(u,"removeResource",(function(){return bi})),n.d(u,"canEquip",(function(){return Pi}));var s={};n.r(s),n.d(s,"moveAliens",(function(){return Ri})),n.d(s,"shootAt",(function(){return Ni})),n.d(s,"turretAi",(function(){return Mi})),n.d(s,"mothershipAi",(function(){return Li})),n.d(s,"resourceDroidAi",(function(){return Oi})),n.d(s,"unloadDroid",(function(){return Hi})),n.d(s,"loadDroid",(function(){return Di})),n.d(s,"hasDroids",(function(){return Ci})),n.d(s,"summonAllDroids",(function(){return Fi})),n.d(s,"getTargetPlanetWithResources",(function(){return ji})),n.d(s,"getNearestOpponentTarget",(function(){return Ui})),n.d(s,"getNearestFriendlyTarget",(function(){return Gi})),n.d(s,"missileAi",(function(){return ki})),n.d(s,"goAround",(function(){return Wi})),n.d(s,"getXYToMoveTowards",(function(){return Bi})),n.d(s,"willCollideWithShip",(function(){return Yi})),n.d(s,"willCollideWithPlanet",(function(){return qi})),n.d(s,"creeperAi",(function(){return Qi})),n.d(s,"getNearestAlienTarget",(function(){return Ki})),n.d(s,"getNearestPlayerTarget",(function(){return Xi})),n.d(s,"getNearestShip",(function(){return Vi})),n.d(s,"checkForCollisionWithPlanet",(function(){return Ji})),n.d(s,"checkForCollisionWithShip",(function(){return zi})),n.d(s,"enableShieldIfNeeded",(function(){return Zi})),n.d(s,"getShield",(function(){return $i}));var l={};n.r(l),n.d(l,"saveLocalStorage",(function(){return eo})),n.d(l,"loadLocalStorage",(function(){return to})),n.d(l,"loadWorld",(function(){return ro})),n.d(l,"saveWorld",(function(){return ao})),n.d(l,"deleteWorld",(function(){return io}));var c=n(0),d=n.n(c),m=n(14),p=n.n(m),E=(n(35),n(17)),f=n(18),h=n(23),w=n(22),y=(n(36),n(26)),I=n.n(y);function _(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))}function S(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}function g(e){var t=e;return t<0&&(t+=2*Math.PI),t>2*Math.PI&&(t-=2*Math.PI),t}function v(e,t,n){var r=_(e,t,n.x,n.y);r<10&&(r=10);var i=Math.atan2(e-n.x,t-n.y);return{x:a.GRAVITATIONAL_CONST*n.mass/Math.pow(r,2)*-Math.sin(i),y:a.GRAVITATIONAL_CONST*n.mass/Math.pow(r,2)*-Math.cos(i),dir:i}}function A(e,t,n,r){return g(Math.atan2(r-t,n-e))}function T(e,t){return{xAmt:t*Math.cos(e),yAmt:t*Math.sin(e)}}function x(e,t){var n=Math.ceil(e),r=Math.floor(t);return Math.floor(Math.random()*(r-n+1)+n)}function b(e,t){return e+Math.random()*(t-e)}function P(){return Math.random()>.5}function R(e,t,n,r){return{x:e+r*Math.cos(n),y:t+r*Math.sin(n)}}function N(e,t,n){n.calculateVertices();var r=n.vertexData.map((function(e){return e/window.world.system.screenScale})),a=[];return a.push(M(e,t,r[0],r[1])),a.push(M(e,t,r[2],r[3])),a.push(M(e,t,r[4],r[5])),a.push(M(e,t,r[6],r[7])),a.push(S(a[0],a[1])),a.push(S(a[1],a[2])),a.push(S(a[2],a[3])),a.push(S(a[3],a[0])),a}function M(e,t,n,r){return[e+(n-a.HALF_SCREEN_WIDTH),t+(r-a.HALF_SCREEN_HEIGHT)]}function L(e,t,n,r,a){n.calculateVertices();var i=n.vertexData.map((function(e){return e/window.world.system.screenScale})),o=M(e,t,i[0],i[1]),u=M(e,t,i[2],i[3]),s=M(e,t,i[6],i[7]),l=O(o,u),c=O(o,s),d=O(o,[r,a]),m=H(d,l),p=H(l,l),E=H(d,c),f=H(c,c);return 0<=m&&m<=p&&0<=E&&E<=f}function O(e,t){return[t[0]-e[0],t[1]-e[1]]}function H(e,t){return e[0]*t[0]+e[1]*t[1]}function D(e){var t={};t.value=e.toLowerCase(),t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.key.toLowerCase()===t.value&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1)},t.upHandler=function(e){e.key.toLowerCase()===t.value&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0)};var n=t.downHandler.bind(t),r=t.upHandler.bind(t);return window.addEventListener("keydown",n,!1),window.addEventListener("keyup",r,!1),t.unsubscribe=function(){window.removeEventListener("keydown",n),window.removeEventListener("keyup",r)},t}function C(e){I.a.fire({title:e,timer:5e3,position:"top-left",showConfirmButton:!1,toast:!0,width:"40vw",showClass:{popup:"animate__animated animate__slideInDown"},hideClass:{popup:"animate__animated animate__slideOutUp"}}).then()}var F,j,U=n(3),G="0.5th",k=0,W=16763989,B=43775,Y=16777215,q=2105376,Q=3158064,K=9474192,X=8421504,V=5242880,J=20480,z=5242960,Z={INIT:"init",FLY:"fly",MANAGE:"manage"},$="saved-game-names",ee=1e3,te=1e3,ne=ee/2,re=te/2,ae=3*ee,ie=3*te,oe=250,ue=250,se=oe/2,le=ue/2,ce=8e3,de=8e3,me=ce/2,pe=de/2,Ee=oe/ce,fe=ue/de,he="images/spritesheet.json",we="alien_black.png",ye="alien_blue.png",Ie="alien_blue_large.png",_e="alien_blue_small.png",Se="alien_fire.png",ge="alien_green.png",ve="alien_green_small.png",Ae="alien_green_large.png",Te="alien_red.png",xe="alien_red_small.png",be="alien_red_large.png",Pe="bullet.png",Re="bullet_blue.png",Ne="bullet_white.png",Me="factory.png",Le="mine",Oe="planet_green.png",He="planet_purple.png",De="planet_red.png",Ce="planet_rock.png",Fe="wormhole_sprite",je="shield_blue.png",Ue="shield_green.png",Ge="shield_white.png",ke="ship_ball.png",We="ship_cargo.png",Be="ship_explorer.png",Ye="ship_fast.png",qe="ship_fighter.png",Qe="ship_heavy.png",Ke="ship_missile.png",Xe="ship_red_wings.png",Ve="ship_skeleton.png",Je="images/stars.png",ze="images/crash.json",Ze="crash",$e="images/smoke.json",et="smoke",tt=4e4,nt=5e4,rt=7e4,at="player",it="alien",ot={titanium:30,gold:20,uranium:0},ut=2,st=2,lt=10,ct=99999999,dt=-(tt+1e3),mt=0,pt=50,Et=3,ft=K,ht=Q,wt=B,yt=Y,It=W,_t=(F={},Object(U.a)(F,Ce,X),Object(U.a)(F,De,V),Object(U.a)(F,Oe,J),Object(U.a)(F,He,z),Object(U.a)(F,Fe,q),F),St=.05,gt="mine",vt=1,At=52,Tt=.5,xt=.0166,bt=.0083,Pt=.0033,Rt={titanium:20,gold:10,uranium:0},Nt=.5,Mt="factory",Lt={titanium:50,gold:20,uranium:10},Ot=91,Ht=.8,Dt="Brake",Ct="Primary Weapon",Ft="Secondary Weapon",jt="Thruster",Ut="Armor",Gt="Repair Droid",kt="Gunnery Droid",Wt="Shield Droid",Bt="Speed",Yt="Turn",qt="Storage",Qt="Autolander",Kt="GravityShield",Xt="Thrust Momentum",Vt="Thrust Blink",Jt="Equip",zt="Ship",Zt="ALIEN_AI_TURRET",$t="ALIEN_AI_CREEPER",en="ALIEN_AI_MOTHERSHIP",tn="ALIEN_AI_KAMIKAZI",nn="EQUIP_AI_MINE",rn="EQUIP_AI_TURRET",an="EQUIP_AI_MISSILE",on="EQUIP_AI_RESOURCE_DROID",un="ahead",sn="behind",ln={name:"Brake",objType:Jt,type:Dt,brakeSpeedPct:.04,cost:{titanium:20,gold:10,uranium:0},description:"Slows your ship down."},cn={name:"Blink Brake",objType:Jt,type:Dt,brakeSpeedPct:0,cost:{titanium:50,gold:50,uranium:30},description:"Stops your ship immediately."},dn={name:"Speed Booster",objType:Jt,type:Bt,boostSpeed:.05,cost:{titanium:0,gold:20,uranium:10},description:"Increase the ship's acceleration. Helps slow ships take off of large planets."},mn={name:"Turn Booster",objType:Jt,type:Yt,boostSpeed:.04,cost:{titanium:0,gold:10,uranium:20},description:"Increase turning speed."},pn={name:"Storage",objType:Jt,type:qt,storageAmount:100,cost:{titanium:30,gold:0,uranium:0},description:"100 more resource storage."},En={name:"Enhanced Storage",objType:Jt,type:qt,storageAmount:300,cost:{titanium:200,gold:0,uranium:0},description:"300 more resources."},fn={name:"Armor Plate",objType:Jt,type:Ut,armorAmt:100,cost:{titanium:50,gold:0,uranium:0},description:"Increase armor by 100."},hn={name:"Enhanced Armor",objType:Jt,type:Ut,armorAmt:300,cost:{titanium:300,gold:0,uranium:0},description:"Increase armor by 300."},wn={name:"Thruster",objType:Jt,type:jt,thrustSpeed:.08,thrustType:Xt,cost:{titanium:40,gold:40,uranium:10},description:"Enable lateral movement. Use 'q' and 'e' keys."},yn={name:"Blink Thruster",objType:Jt,type:jt,thrustSpeed:2.5,thrustType:Vt,cost:{titanium:60,gold:50,uranium:10},description:"Lateral movement without momentum. Use 'q' and 'e' keys."},In={name:"Auto Lander",objType:Jt,type:Qt,cost:{titanium:60,gold:50,uranium:10},description:"Never crash into a planet again!"},_n={name:"Gravity Shield",objType:Jt,type:Kt,cost:{titanium:100,gold:200,uranium:150},description:"Be free from the effect of gravity."},Sn={name:"Blaster",objType:Jt,type:Ct,coolTime:25,cool:0,damage:10,speed:2.5,lifetime:100,jitter:.05,bulletFile:Pe,cost:{titanium:0,gold:0,uranium:10}},gn={name:"Fast Blaster",objType:Jt,type:Ct,coolTime:10,cool:0,damage:7.5,speed:4,lifetime:75,jitter:.05,bulletFile:Pe,cost:{titanium:20,gold:20,uranium:40}},vn={name:"Sprinkler Blaster",objType:Jt,type:Ct,coolTime:2,cool:0,damage:8,speed:2.5,lifetime:150,jitter:1,bulletFile:Pe,cost:{titanium:10,gold:10,uranium:80}},An={name:"Stream Blaster",objType:Jt,type:Ct,coolTime:4,cool:0,damage:8,speed:7,lifetime:70,jitter:.04,bulletFile:Pe,cost:{titanium:0,gold:50,uranium:150}},Tn={name:"Melee Gun",objType:Jt,type:Ct,coolTime:3,cool:0,damage:12,speed:3,lifetime:40,jitter:.25,bulletFile:Pe,cost:{titanium:0,gold:150,uranium:200}},xn={name:"Sniper Rifle",objType:Jt,type:Ct,coolTime:100,cool:0,damage:160,speed:9,lifetime:90,jitter:0,bulletFile:Pe,cost:{titanium:0,gold:200,uranium:300}},bn={name:"Alien Blaster",objType:Jt,type:Ct,coolTime:20,cool:0,damage:5,speed:2,lifetime:120,jitter:.12,bulletFile:Re,cost:{titanium:0,gold:0,uranium:5}},Pn={name:"Alien Fast Blaster",objType:Jt,type:Ct,coolTime:10,cool:0,damage:12,speed:5,lifetime:110,jitter:.1,bulletFile:Re,cost:{titanium:0,gold:50,uranium:80}},Rn={name:"Alien Lighting Blaster",objType:Jt,type:Ct,coolTime:10,cool:0,damage:25,speed:12,lifetime:50,jitter:.08,bulletFile:Re,cost:{titanium:0,gold:300,uranium:500}},Nn={name:"Staple Gun",objType:Jt,type:Ct,coolTime:3,cool:0,damage:5,speed:3,lifetime:250,jitter:.2,bulletFile:Ne,cost:{titanium:0,gold:50,uranium:200}},Mn={name:"Heavy Staple Gun",objType:Jt,type:Ct,coolTime:3,cool:0,damage:6,speed:3,lifetime:250,jitter:.15,bulletFile:Ne,cost:{titanium:0,gold:250,uranium:400}},Ln={name:"Force Shield",objType:Jt,type:Ft,cool:0,coolTime:600,shield:{active:!1,armor:500,armorMax:500,lifetime:300,lifetimeMax:300,spriteFile:je,radius:0},cost:{titanium:0,gold:100,uranium:10}},On={name:"Weak Shield",objType:Jt,type:Ft,cool:0,coolTime:800,shield:{active:!1,armor:175,armorMax:175,lifetime:300,lifetimeMax:300,spriteFile:je,radius:0},cost:{titanium:0,gold:50,uranium:10}},Hn={name:"Long Shield",objType:Jt,type:Ft,cool:0,coolTime:1200,shield:{active:!1,armor:500,armorMax:500,lifetime:1100,lifetimeMax:1100,spriteFile:Ge,radius:0},cost:{titanium:0,gold:200,uranium:10}},Dn={name:"Strong Shield",objType:Jt,type:Ft,cool:0,coolTime:1e3,shield:{active:!1,armor:1500,armorMax:1500,lifetime:400,lifetimeMax:400,spriteFile:Ue,radius:0},cost:{titanium:0,gold:200,uranium:10}},Cn={name:"Ultra Shield",objType:Jt,type:Ft,cool:0,coolTime:1e3,shield:{active:!1,armor:1200,armorMax:1200,lifetime:800,lifetimeMax:800,spriteFile:je,radius:0},cost:{titanium:0,gold:300,uranium:100}},Fn={name:"Blink Shield",objType:Jt,type:Ft,cool:0,coolTime:600,shield:{active:!1,armor:900,armorMax:900,lifetime:500,lifetimeMax:500,spriteFile:je,radius:0},cost:{titanium:0,gold:500,uranium:100}},jn={name:"Alien Missile",objType:zt,propulsion:.08,turnSpeed:.3,resourcesMax:0,resources:{titanium:0,gold:0,uranium:0},equipMax:0,equip:[],armorMax:200,armor:200,crashSpeed:2,crashAngle:10,imageScale:.8,imageFile:xe,cost:{titanium:5,gold:5,uranium:10},viewRange:3*ee,aiType:tn},Un={name:"Alien Missile Launcher",objType:Jt,type:Ft,coolTime:100,cool:100,createShip:{type:jn,dir:un},cost:{titanium:150,gold:150,uranium:200},description:"Fires red alien missiles that persistently follow enemies."},Gn={name:"R2D2 Repair Droid",objType:Jt,type:Gt,repairSpeed:.2,cost:{titanium:50,gold:300,uranium:100},description:"Repairs your ship while you are flying."},kn={name:"Gunnery Droid",objType:Jt,type:kt,weapon:gn,cost:{titanium:100,gold:400,uranium:200},description:"Fires a fast blaster at the nearest enemy."},Wn={name:"Lightning Droid",objType:Jt,type:kt,weapon:Rn,cost:{titanium:100,gold:500,uranium:300},description:"Fires a lightning blaster at the nearest enemy."},Bn={name:"Shield Droid",objType:Jt,type:Wt,cost:{titanium:50,gold:600,uranium:50},description:"Deploys your shields automatically when bullets are flying."},Yn={name:"Explorer",objType:zt,propulsion:.05,turnSpeed:.05,resourcesMax:50,resources:{titanium:0,gold:0,uranium:0},equipMax:4,equip:[ln,Sn],armorMax:50,armor:50,crashSpeed:2,crashAngle:.5,imageScale:.6,imageFile:Be,cost:{titanium:40,gold:20,uranium:10},description:"A basic ship with good handling and 4 slots."},qn={name:"Cargo",objType:zt,propulsion:.025,turnSpeed:.02,resourcesMax:750,resources:{titanium:0,gold:0,uranium:0},equipMax:3,equip:[ln],armorMax:20,armor:20,crashSpeed:1.2,crashAngle:.3,imageScale:1,imageFile:We,cost:{titanium:100,gold:50,uranium:50},description:"A large, slow ship that can carry 750 resources, but only has 3 slots."},Qn={name:"Fast",objType:zt,propulsion:.1,turnSpeed:.07,resourcesMax:40,resources:{titanium:0,gold:0,uranium:0},equipMax:5,equip:[ln],armorMax:50,armor:50,crashSpeed:2,crashAngle:.5,imageScale:.6,imageFile:Ye,cost:{titanium:200,gold:100,uranium:50},description:"A fast ship with good handling and 5 slots."},Kn={name:"Skeleton",objType:zt,propulsion:.03,turnSpeed:.03,resourcesMax:30,resources:{titanium:0,gold:0,uranium:0},equipMax:8,equip:[],armorMax:50,armor:50,crashSpeed:2,crashAngle:.5,imageScale:.7,imageFile:Ve,cost:{titanium:200,gold:200,uranium:50},description:"A framework with 8 slots that makes it flexible."},Xn={name:"Heavy",objType:zt,propulsion:.055,turnSpeed:.05,resourcesMax:300,resources:{titanium:0,gold:0,uranium:0},equipMax:8,equip:[ln],armorMax:500,armor:500,crashSpeed:1.5,crashAngle:.4,imageScale:.5,imageFile:Qe,cost:{titanium:500,gold:400,uranium:300},description:"A large ship with 500 armor, 300 resources and 8 slots."},Vn={name:"Fighter",objType:zt,propulsion:.08,turnSpeed:.07,resourcesMax:200,resources:{titanium:0,gold:0,uranium:0},equipMax:10,equip:[ln],armorMax:300,armor:300,crashSpeed:1.5,crashAngle:.6,imageScale:.6,imageFile:qe,cost:{titanium:500,gold:500,uranium:500},description:"A fast, ship with 300 armor, 200 resources and 10 slots."},Jn={name:"Wing Ship",objType:zt,propulsion:.075,turnSpeed:.06,resourcesMax:300,resources:{titanium:0,gold:0,uranium:0},equipMax:12,equip:[cn],armorMax:500,armor:500,crashSpeed:3,crashAngle:.5,imageScale:.7,imageFile:Xe,cost:{titanium:1e3,gold:1e3,uranium:1e3},description:"A large ship with good handling 500 armor, 300 resources and 12 slots."},zn={name:"Alien Turret",objType:zt,propulsion:.001,turnSpeed:.05,resourcesMax:100,resources:{titanium:0,gold:0,uranium:0},equipMax:3,equip:[ln,bn],armorMax:100,armor:100,crashSpeed:2,crashAngle:10,imageScale:.8,imageFile:ve,cost:{titanium:50,gold:50,uranium:50},aiType:Zt,description:"A basic turret with an alien blaster"},Zn={name:"Alien Ship",objType:zt,propulsion:.05,turnSpeed:.05,resourcesMax:100,resources:{titanium:0,gold:0,uranium:0},equipMax:5,equip:[ln,bn],armorMax:100,armor:100,crashSpeed:2,crashAngle:10,imageScale:.9,imageFile:ge,cost:{titanium:150,gold:100,uranium:80},aiType:$t,description:"The basic alien scout ship."},$n={name:"Alien Large",objType:zt,propulsion:.03,turnSpeed:.05,resourcesMax:100,resources:{titanium:0,gold:0,uranium:0},equipMax:8,equip:[ln,Pn],armorMax:300,armor:300,crashSpeed:2,crashAngle:10,imageScale:1,imageFile:Ae,cost:{titanium:150,gold:100,uranium:80},aiType:$t,description:"A large heavily armored alien."},er={name:"Alien Staple Turret",objType:zt,propulsion:0,turnSpeed:.001,resourcesMax:100,resources:{titanium:0,gold:0,uranium:0},equipMax:3,equip:[ln,Mn],armorMax:230,armor:230,crashSpeed:2,crashAngle:10,imageScale:1.3,imageFile:_e,cost:{titanium:150,gold:150,uranium:200},aiType:Zt,description:"A hard-to-hit turret with a heavy staple gun."},tr={name:"Alien Lightning Turret",objType:zt,propulsion:0,turnSpeed:.001,resourcesMax:100,resources:{titanium:0,gold:0,uranium:0},equipMax:1,equip:[Rn],armorMax:300,armor:300,crashSpeed:2,crashAngle:10,imageScale:1.5,imageFile:_e,cost:{titanium:100,gold:200,uranium:300},aiType:Zt,description:"A turret that shoots lightning bolts."},nr={name:"Alien Fire",objType:zt,propulsion:.08,turnSpeed:.05,resourcesMax:100,resources:{titanium:0,gold:0,uranium:0},equipMax:8,equip:[ln,Mn,Hn],armorMax:450,armor:450,crashSpeed:2,crashAngle:.4,imageScale:1.5,imageFile:Se,cost:{titanium:250,gold:200,uranium:80},aiType:$t,description:"A tough alien ship with a shield and heavy staple gun."},rr={name:"Alien Stealth",objType:zt,propulsion:.04,turnSpeed:.05,resourcesMax:100,resources:{titanium:0,gold:0,uranium:0},equipMax:6,equip:[ln,Pn],armorMax:150,armor:150,crashSpeed:2,crashAngle:10,imageScale:1.5,imageFile:we,cost:{titanium:100,gold:200,uranium:150},aiType:$t,description:"An alien with a cloak making it hard to see."},ar={name:"Alien Mothership",objType:zt,propulsion:0,turnSpeed:.001,resourcesMax:1e4,resources:{titanium:1e3,gold:1e3,uranium:2e3},equipMax:10,equip:[ln,Un,Cn,Rn],armorMax:1e3,armor:1e3,crashSpeed:3,crashAngle:10,imageScale:1.3,imageFile:be,cost:{titanium:1200,gold:1e3,uranium:750},aiType:en,description:"A large heavily armored ship with smart missiles."},ir={name:"Decoy",objType:zt,propulsion:0,turnSpeed:0,resourcesMax:0,resources:{titanium:0,gold:0,uranium:0},equipMax:0,equip:[],armorMax:350,armor:350,crashSpeed:2,crashAngle:10,imageScale:.55,imageFile:Be,cost:{titanium:10,gold:0,uranium:0},aiType:nn,description:"An empty shell of a ship."},or={name:"Turret",objType:zt,propulsion:0,turnSpeed:0,resourcesMax:0,resources:{titanium:0,gold:0,uranium:0},equipMax:1,equip:[gn],armorMax:350,armor:350,crashSpeed:2,crashAngle:10,imageScale:.6,imageFile:Ie,cost:{titanium:5,gold:10,uranium:5},aiType:rn,description:"A turret with a fast blaster."},ur={name:"Stream Turret",objType:zt,propulsion:0,turnSpeed:0,resourcesMax:0,resources:{titanium:0,gold:0,uranium:0},equipMax:1,equip:[An],armorMax:250,armor:250,crashSpeed:2,crashAngle:10,imageScale:.4,imageFile:Ie,cost:{titanium:10,gold:30,uranium:20},aiType:rn,description:"A turret with a stream blaster"},sr={name:"Missile",objType:zt,propulsion:.08,turnSpeed:.25,resourcesMax:0,resources:{titanium:0,gold:0,uranium:0},equipMax:0,equip:[],armorMax:250,armor:250,crashSpeed:2,crashAngle:10,imageScale:1,imageFile:ke,cost:{titanium:0,gold:15,uranium:15},aiType:an,description:"An enemy seeking missile."},lr={name:"Bomb",objType:zt,propulsion:.05,turnSpeed:.1,resourcesMax:0,resources:{titanium:0,gold:0,uranium:0},equipMax:0,equip:[],armorMax:70,armor:70,crashSpeed:2,crashAngle:10,imageScale:.5,imageFile:Te,cost:{titanium:0,gold:0,uranium:30},aiType:an,description:"When it dies it detonates damaging everything nearby"},cr={name:"Friendship Missile",objType:zt,propulsion:.09,turnSpeed:.25,resourcesMax:0,resources:{titanium:0,gold:0,uranium:0},equipMax:0,equip:[On],armorMax:40,armor:40,crashSpeed:2,crashAngle:10,imageScale:.5,imageFile:ye,cost:{titanium:5,gold:30,uranium:0},aiType:an,description:"A missile that turns enemies into friends."},dr={name:"Resource Droid",objType:zt,propulsion:.1,turnSpeed:.1,resourcesMax:50,resources:{titanium:0,gold:0,uranium:0},equipMax:0,equip:[],armorMax:10,armor:10,crashSpeed:2,crashAngle:10,imageScale:1,imageFile:Ke,cost:{titanium:30,gold:20,uranium:0},aiType:on,autonomousShip:!0,description:"Self-piloting ship that brings resources to this planet."},mr=[zn,Zn,$n,rr,er,nr,ar],pr=[Yn,qn,Qn,dr,Kn,Xn,Vn,Jn].concat(mr),Er={name:"Decoy Deployer",objType:Jt,type:Ft,coolTime:25,cool:0,createShip:{type:ir,dir:sn},cost:{titanium:0,gold:50,uranium:100},description:"Drops a fake ship."},fr={name:"Turret Deployer",objType:Jt,type:Ft,coolTime:100,cool:0,createShip:{type:or,dir:sn},cost:{titanium:0,gold:200,uranium:100},description:"Drops a turret with a fast blaster."},hr={name:"Stream Turret Deployer",objType:Jt,type:Ft,coolTime:100,cool:0,createShip:{type:ur,dir:sn},cost:{titanium:100,gold:400,uranium:400},description:"Drops a turret with a stream blaster."},wr={name:"Missile Launcher",objType:Jt,type:Ft,coolTime:100,cool:0,createShip:{type:sr,dir:un},cost:{titanium:50,gold:250,uranium:300},description:"Fires enemy-seeking missiles."},yr={name:"Bomb Launcher",objType:Jt,type:Ft,coolTime:80,cool:0,createShip:{type:lr,dir:un},cost:{titanium:250,gold:300,uranium:400},description:"Fires explosive missiles."},Ir={name:"Friendship Gun",objType:Jt,type:Ft,coolTime:150,cool:0,createShip:{type:cr,dir:un},cost:{titanium:100,gold:300,uranium:100},description:"Fires a missile that turns your enemies into allies."},_r=[ln,cn,wn,yn,fn,dn,mn,pn,hn,En,In,_n],Sr=[Sn,gn,An,vn,Tn,xn,bn,Nn,Mn,Pn,Rn],gr=[Er,fr,hr,wr,yr,Un,Ir,Ln,Hn,Dn,Cn,Fn],vr=[Gn,kn,Wn,Bn],Ar=[].concat(_r,Sr,gr,vr),Tr=(j={},Object(U.a)(j,Ce,[{xp:1,obj:Sn},{xp:10,obj:ln},{xp:50,obj:Yn},{xp:100,obj:qn},{xp:200,obj:fn},{xp:1e3,obj:dn}]),Object(U.a)(j,De,[{xp:10,obj:pn},{xp:50,obj:cn},{xp:100,obj:wn},{xp:500,obj:Qn},{xp:1e3,obj:In},{xp:2e3,obj:mn}]),Object(U.a)(j,Oe,[{xp:10,obj:Kn},{xp:50,obj:Gn},{xp:500,obj:Xn},{xp:1e3,obj:yn}]),Object(U.a)(j,He,[{xp:300,obj:Dn},{xp:750,obj:kn},{xp:1e3,obj:Vn},{xp:2e3,obj:Cn}]),Object(U.a)(j,zn.name,[{xp:1,obj:gn},{xp:5,obj:bn},{xp:10,obj:Er}]),Object(U.a)(j,Zn.name,[{xp:1,obj:Ln},{xp:5,obj:dr},{xp:10,obj:Pn},{xp:20,obj:Hn},{xp:30,obj:Zn}]),Object(U.a)(j,$n.name,[{xp:1,obj:fr},{xp:5,obj:An},{xp:10,obj:En},{xp:15,obj:xn},{xp:25,obj:$n}]),Object(U.a)(j,rr.name,[{xp:1,obj:vn},{xp:7,obj:wr},{xp:15,obj:Ir}]),Object(U.a)(j,er.name,[{xp:1,obj:Nn},{xp:5,obj:Tn},{xp:10,obj:hn},{xp:15,obj:yr},{xp:20,obj:Bn}]),Object(U.a)(j,nr.name,[{xp:1,obj:Mn},{xp:5,obj:Fn},{xp:10,obj:hr},{xp:20,obj:_n},{xp:30,obj:nr}]),Object(U.a)(j,ar.name,[{xp:1,obj:Rn},{xp:2,obj:Un},{xp:3,obj:Wn},{xp:4,obj:Jn}]),j),xr=new Map;xr.set(Ce,.026),xr.set(De,.021),xr.set(Oe,.014),xr.set(He,.011),xr.set(Fe,15);var br=[{planetCount:1,minDist:1,maxDist:2,minDistToOtherPlanet:10,minPlanetRadius:1500,maxPlanetRadius:1501,planetFiles:[He],aliens:[{count:0,file:null}]},{planetCount:0,minDist:1700,maxDist:2500,minDistToOtherPlanet:10,minPlanetRadius:10,maxPlanetRadius:10,planetFiles:[],aliens:[{count:50,file:rr},{count:75,file:nr},{count:30,file:er}]},{planetCount:180,minDist:2500,maxDist:1e4,minDistToOtherPlanet:150,minPlanetRadius:300,maxPlanetRadius:600,planetFiles:[De,He,Oe],aliens:[{count:400,file:er},{count:500,file:$n},{count:500,file:rr}]},{planetCount:20,minDist:2501,maxDist:10001,minDistToOtherPlanet:200,minPlanetRadius:10,maxPlanetRadius:20,planetFiles:[Fe],aliens:[]},{planetCount:0,minDist:8e3,maxDist:12e3,minDistToOtherPlanet:10,minPlanetRadius:10,maxPlanetRadius:10,planetFiles:[De],aliens:[{count:100,file:er},{count:400,file:rr}]},{planetCount:1e3,minDist:1e4,maxDist:2e4,minDistToOtherPlanet:150,minPlanetRadius:200,maxPlanetRadius:360,planetFiles:[Ce,De,Oe],aliens:[{count:400,file:zn},{count:800,file:Zn},{count:400,file:$n}]},{planetCount:20,minDist:10001,maxDist:20001,minDistToOtherPlanet:200,minPlanetRadius:10,maxPlanetRadius:20,planetFiles:[Fe],aliens:[]},{planetCount:2e3,minDist:2e4,maxDist:3e4,minDistToOtherPlanet:200,minPlanetRadius:170,maxPlanetRadius:220,planetFiles:[Ce,De],aliens:[{count:1300,file:zn},{count:400,file:Zn}]},{planetCount:1e3,minDist:3e4,maxDist:35e3,minDistToOtherPlanet:300,minPlanetRadius:150,maxPlanetRadius:180,planetFiles:[Ce],aliens:[{count:600,file:zn}]},{planetCount:20,minDist:20001,maxDist:35001,minDistToOtherPlanet:200,minPlanetRadius:10,maxPlanetRadius:20,planetFiles:[Fe],aliens:[]},{planetCount:900,minDist:35e3,maxDist:tt,minDistToOtherPlanet:500,minPlanetRadius:80,maxPlanetRadius:150,planetFiles:[Ce],aliens:[]},{planetCount:20,minDist:tt-300,maxDist:tt+800,minDistToOtherPlanet:500,minPlanetRadius:10,maxPlanetRadius:20,planetFiles:[Fe],aliens:[]}],Pr=n(5),Rr=n(1),Nr=n(16),Mr=n(7),Lr=n.n(Mr);function Or(){var e;return{appVersion:a.APP_VERSION,saveGameName:null,ship:null,view:{x:0,y:0},ships:[],planets:[],selectedPlanet:{resources:{}},lastPlanetLanded:null,gameTickCount:0,nextId:100,introDialogShown:!1,blueprints:{ship:[],equip:[],xp:(e={},Object(U.a)(e,a.PLANET_ROCK_FILE,0),Object(U.a)(e,a.PLANET_RED_FILE,0),Object(U.a)(e,a.PLANET_GREEN_FILE,0),Object(U.a)(e,a.PLANET_PURPLE_FILE,0),Object(U.a)(e,a.SHIP_ALIEN_TURRET.name,0),Object(U.a)(e,a.SHIP_ALIEN.name,0),Object(U.a)(e,a.SHIP_ALIEN_LARGE.name,0),Object(U.a)(e,a.SHIP_ALIEN_STEALTH.name,0),Object(U.a)(e,a.SHIP_ALIEN_STAPLE_TURRET.name,0),Object(U.a)(e,a.SHIP_ALIEN_FIRE.name,0),Object(U.a)(e,a.SHIP_ALIEN_MOTHERSHIP.name,0),e),xpLevels:Lr.a.cloneDeep(a.XP_LEVELS)},system:{keys:{},buttonKeyDown:{up:!1,right:!1,down:!1,left:!1,shoot:!1,x:!1},app:null,gameState:a.GAME_STATE.INIT,isTyping:!1,gameLoop:null,bgSprite:null,smokeSheet:null,explosionSheet:null,explosions:[],bullets:[],nearby:{planets:[],ships:[]},planetSpriteCache:{},shipSpriteCache:{},shieldSpriteCache:new Map,spriteContainers:{background:null,planets:null,bullets:null,ships:null,minimap:null,explosions:null},screenHeight:a.SCREEN_HEIGHT,screenWidth:a.SCREEN_WIDTH,screenScale:1,miniMapGraphics:null,initializing:!0,continuousFire:!1,continuousFireUp:!1}}}function Hr(){var e=window.world;Dr(),Cr(),Fr(),function(){var e,t=window.world.planets,n=Object(Rr.a)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.spriteFile===a.WORMHOLE_SPRITE){for(var i=null,o=t.length-1;o>=0;o--)if(t[o].spriteFile===a.WORMHOLE_SPRITE&&!t[o].jumpToX&&!t[o].jumpToY){i=t[o];break}i&&(r.jumpToX=i.x,r.jumpToY=i.y,i.jumpToX=r.x,i.jumpToY=r.y)}}}catch(u){n.e(u)}finally{n.f()}}(),e.selectedPlanet=e.planets[0],window.world.shipStartX=a.PLAYER_START_X,window.world.shipStartY=a.PLAYER_START_Y,e.ship=Kr(a.SHIP_EXPLORER,a.PLAYER),Br(e.ship).visible=!0,e.ship.resources=a.PLAYER_STARTING_RESOURCES;Vr(),Jr(),zr(),ua()}function Dr(){var e=window.world.system.app.stage,t=window.world.system.spriteContainers;t.background=new window.PIXI.Container,e.addChild(t.background);var n=window.PIXI.Loader.shared.resources[a.SMOKE_JSON];window.world.system.smokeSheet=n.spritesheet,t.planets=new window.PIXI.Container,e.addChild(t.planets),t.bullets=new window.PIXI.Container,e.addChild(t.bullets),t.ships=new window.PIXI.Container,e.addChild(t.ships),t.explosions=new window.PIXI.Container,e.addChild(t.explosions),t.minimap=new window.PIXI.Container,e.addChild(t.minimap)}function Cr(){var e=window.world.system.spriteContainers.background;window.world.system.bgSprite=new window.PIXI.TilingSprite(window.PIXI.Texture.from(a.STAR_BACKGROUND_FILE),a.SCREEN_WIDTH,a.SCREEN_HEIGHT),e.addChild(window.world.system.bgSprite)}function Fr(){var e,t=Object(Rr.a)(a.UNIVERSE_RINGS);try{for(t.s();!(e=t.n()).done;)for(var n=e.value,i=0;i<n.planetCount;i++){var o=n.planetFiles[r.randomInt(0,n.planetFiles.length-1)],u=String.fromCharCode(65+Math.floor(26*Math.random()))+r.randomInt(1e3,999999),s=r.randomInt(n.minPlanetRadius,n.maxPlanetRadius),l=s*s*a.PLANET_DENSITY.get(o),c=2*l*.3,d=.15*l;s>1e3?(d+=1e4,c+=1e4):s>500&&(d+=500,c+=500);var m=kr(o,u,s,l,{titanium:r.randomInt(d,c),gold:r.randomInt(d,c),uranium:r.randomInt(d,c)}),p=Gr(m,n.minDistToOtherPlanet,0,n.minDist,n.maxDist),E=p.x,f=p.y;m.x=E,m.y=f}}catch(h){t.e(h)}finally{t.f()}}function jr(e,t,n){var a,i=99999999999,o=null,u=Object(Rr.a)(window.world.planets);try{for(u.s();!(a=u.n()).done;){var s=a.value;if(s!==e){var l=r.distanceBetween(t,n,s.x,s.y)-s.radius;e&&(l-=e.radius),(!o||l<i)&&(i=l,o=s)}}}catch(c){u.e(c)}finally{u.f()}return{nearestPlanet:o,nearestPlanetDist:i}}function Ur(e,t){var n,a=99999999999,i=null,o=Object(Rr.a)(window.world.system.nearby.ships);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(u!==window.world.ship){var s=r.distanceBetween(e,t,u.x,u.y)-2*u.radius;(!i||s<a)&&(a=s,i=u)}}}catch(l){o.e(l)}finally{o.f()}return{nearestAlien:i,nearestAlienDist:a}}function Gr(e,t,n,i,o){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=r.randomFloat(0,2*Math.PI),l=r.randomInt(i,o),c=r.getPointFrom(0,0,s,l),d=c.x,m=c.y;if(u>200)return console.warn("Had a hard time finding a spot in ring "+i+"-"+o+" dumping to outer ring"),Gr(e,t,n,a.OUTER_RING_MIN,a.OUTER_RING_MAX,0);if(t>0){var p=jr(e,d,m),E=p.nearestPlanetDist;if(E<t)return Gr(e,t,n,i,o,++u)}if(n>0){var f=Ur(d,m),h=f.nearestAlienDist;if(h<n)return Gr(e,t,n,i,o,++u)}return e&&e.spriteFile===a.WORMHOLE_SPRITE&&r.distanceBetween(d,m,a.PLAYER_START_X,a.PLAYER_START_Y)<a.MINIMAP_VIEW_HEIGHT?Gr(e,t,n,i,o,++u):{x:d,y:m}}function kr(e,t,n,r,a){var i={};return i.id=window.world.nextId++,i.name=t,i.x=0,i.y=0,i.mass=r,i.resources={stored:{titanium:0,gold:0,uranium:0},raw:a},i.ships=[],i.equip=[],i.buildings=[],i.radius=n,i.lastLandingDir=0,i.spriteFile=e,i.spriteId=null,window.world.planets.push(i),i}function Wr(e){var t=window.world.system.planetSpriteCache[e.spriteFile];t||(t=new Map,window.world.system.planetSpriteCache[e.spriteFile]=t);var n=t.get(e.spriteId);if(n)return n;if((n=new window.PIXI.Container).x=0,n.y=0,n.visible=!0,window.world.system.spriteContainers.planets.addChild(n),e.spriteFile===a.WORMHOLE_SPRITE){var r=new window.PIXI.AnimatedSprite(window.world.system.smokeSheet.animations[a.SMOKE]);r.animationSpeed=.2,r.loop=!0,r.anchor.set(.5,.5);var i=2*e.radius/r.width*10;r.scale.set(i,i),r.visible=!0,r.play(),n.addChild(r)}else{var o=new window.PIXI.Sprite(window.PIXI.loader.resources[a.SPRITESHEET_JSON].textures[e.spriteFile]);o.anchor.set(.5,.5);var s=2*e.radius/o.width;e.spriteFile!==a.PLANET_PURPLE_FILE&&e.spriteFile!==a.PLANET_GREEN_FILE||(s*=1.08),o.scale.set(s,s),n.addChild(o);var l,c=Object(Rr.a)(e.buildings);try{for(c.s();!(l=c.n()).done;){var d=l.value;u.makeBuildingSprite(d,e,n)}}catch(m){c.e(m)}finally{c.f()}}return e.spriteId=window.world.nextId++,t.set(e.spriteId,n),n}function Br(e){var t=window.world.system.shipSpriteCache[e.imageFile];t||(t=new Map,window.world.system.shipSpriteCache[e.imageFile]=t);var n=t.get(e.spriteId);if(n)return n;var r,i=Object(Rr.a)(t.entries());try{for(i.s();!(r=i.n()).done;){var o=Object(Pr.a)(r.value,2),u=o[0],s=o[1];if(!s.visible)return s.visible=!1,s.rotation=e.rotation,s.scale.set(e.imageScale,e.imageScale),e.spriteWidth=s.width,e.spriteHeight=s.height,e.radius=s.width/2,e.spriteId=u,s}}catch(c){i.e(c)}finally{i.f()}var l=window.PIXI.loader.resources[a.SPRITESHEET_JSON];return(n=new window.PIXI.Sprite(l.textures[e.imageFile])).position.set(a.HALF_SCREEN_WIDTH,a.HALF_SCREEN_HEIGHT),n.anchor.set(.5,.5),n.scale.set(e.imageScale,e.imageScale),n.rotation=e.rotation,n.visible=!1,e.spriteWidth=n.width,e.spriteHeight=n.height,e.radius=n.width/2,e.spriteId=window.world.nextId++,t.set(e.spriteId,n),window.world.system.spriteContainers.ships.addChild(n),n}function Yr(e){var t=e.width,n=e.height;e.scale.set(1,1);var r=e.width,a=e.height;return e.width=t,e.height=n,{width:r,height:a}}function qr(e,t,n){var r=Br(e);n.anchor.set(.5,.5);var a=Yr(r),i=a.width,o=a.height,u=1.5*Math.max(i,o);n.width=u,n.height=u,t.radius=u*e.imageScale/2}function Qr(e,t){var n=e.id+"~"+t.spriteFile,r=window.world.system.shieldSpriteCache.get(n);if(r)return qr(e,t,r),r;var i=Br(e),o=window.PIXI.loader.resources[a.SPRITESHEET_JSON];return qr(e,t,r=new window.PIXI.Sprite(o.textures[t.spriteFile])),i.addChild(r),window.world.system.shieldSpriteCache.set(n,r),r}function Kr(e,t){var n=Lr.a.cloneDeep(e);n.id=window.world.nextId++,n.selectedSecondaryWeaponIndex=-1;for(var r=0;r<n.equip.length;r++){var i=n.equip[r];i.id=window.world.nextId++,n.selectedSecondaryWeaponIndex<0&&i.type===a.EQUIP_TYPE_SECONDARY_WEAPON&&(n.selectedSecondaryWeaponIndex=r)}return n.owner=t,n.vx=0,n.vy=0,n.x=window.world.shipStartX,n.y=window.world.shipStartY,n.spriteId=null,n.alive=!0,n.spriteWidth=null,n.rotation=0,window.world.system.nearby.ships.push(n),n}function Xr(e,t,n){var r=Kr(e,a.ALIEN);return window.world.ships.push(r),r.x=t,r.y=n,r.radius=50,r}function Vr(){Xr(a.SHIP_ALIEN_MOTHERSHIP,1700,200),Xr(a.SHIP_ALIEN_MOTHERSHIP,0,1700),Xr(a.SHIP_ALIEN_MOTHERSHIP,-1700,0),Xr(a.SHIP_ALIEN_MOTHERSHIP,0,-1700);var e,t=Object(Rr.a)(a.UNIVERSE_RINGS);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=Object(Rr.a)(r.aliens);try{for(i.s();!(n=i.n()).done;)for(var o=n.value,u=0;u<o.count;u++){var s=Gr(null,a.MIN_ALIEN_DIST_TO_PLANET,a.MIN_ALIEN_DIST_TO_ALIEN,r.minDist,r.maxDist),l=s.x,c=s.y;Xr(o.file,l,c)}}catch(d){i.e(d)}finally{i.f()}}}catch(d){t.e(d)}finally{t.f()}}function Jr(){for(var e=0,t=[{type:a.PLANET_ROCK_FILE,name:"X500",x:a.UNIVERSE_RADIUS+3e3,y:0,radius:100,mass:100,resources:{titanium:r.randomInt(100,500),gold:r.randomInt(100,500),uranium:r.randomInt(500,1e3)}},{type:a.PLANET_ROCK_FILE,name:"X400",x:a.UNIVERSE_RADIUS+5e3,y:0,radius:200,mass:100,resources:{titanium:r.randomInt(100,500),gold:r.randomInt(100,500),uranium:r.randomInt(500,1e3)}},{type:a.PLANET_ROCK_FILE,name:"X300",x:a.UNIVERSE_RADIUS+1e4,y:0,radius:300,mass:150,resources:{titanium:r.randomInt(200,500),gold:r.randomInt(200,1500),uranium:r.randomInt(1e3,1500)}},{type:a.PLANET_ROCK_FILE,name:"X200",x:a.UNIVERSE_RADIUS+16e3,y:0,radius:300,mass:150,resources:{titanium:r.randomInt(200,500),gold:r.randomInt(200,1500),uranium:r.randomInt(1e3,1500)}},{type:a.PLANET_ROCK_FILE,name:"X100",x:a.UNIVERSE_RADIUS+25e3,y:0,radius:300,mass:150,resources:{titanium:r.randomInt(200,500),gold:r.randomInt(200,1500),uranium:r.randomInt(1e3,1500)}},{type:a.PLANET_ROCK_FILE,name:"A",x:a.UNIVERSE_RADIUS+35e3,y:-1500,radius:400,mass:500,resources:{titanium:r.randomInt(3e3,15e3),gold:r.randomInt(3e3,15e3),uranium:r.randomInt(3e3,15e3)}},{type:a.PLANET_ROCK_FILE,name:"B",x:a.UNIVERSE_RADIUS+35e3,y:1500,radius:400,mass:500,resources:{titanium:r.randomInt(3e3,15e3),gold:r.randomInt(3e3,15e3),uranium:r.randomInt(3e3,15e3)}},{type:a.PLANET_ROCK_FILE,name:"C",x:a.UNIVERSE_RADIUS+36500,y:0,radius:400,mass:500,resources:{titanium:r.randomInt(3e3,15e3),gold:r.randomInt(3e3,15e3),uranium:r.randomInt(3e3,15e3)}}];e<t.length;e++){var n=t[e],i=kr(n.type,n.name,n.radius,n.mass,n.resources);i.x=n.x,i.y=n.y}Xr(a.SHIP_ALIEN_MOTHERSHIP,a.UNIVERSE_RADIUS+35e3,400),Xr(a.SHIP_ALIEN_MOTHERSHIP,a.UNIVERSE_RADIUS+35e3,-400),Xr(a.SHIP_ALIEN_MOTHERSHIP,a.UNIVERSE_RADIUS+34800,200),Xr(a.SHIP_ALIEN_MOTHERSHIP,a.UNIVERSE_RADIUS+34800,-200);var o=Lr.a.cloneDeep(a.SHIP_ALIEN_MOTHERSHIP);o.armorMax=1e4,o.armor=1e4,o.imageScale=2,Xr(o,a.UNIVERSE_RADIUS+35e3,0);for(var u=0;u<30;u++){var s=a.UNIVERSE_RADIUS+34e3+x(0,20)-10,l=150*u-3e3;Xr(a.SHIP_ALIEN_FIRE,s,l)}for(var c=0;c<40;c++){var d=a.UNIVERSE_RADIUS+34500,m=150*c-3e3;Xr(a.SHIP_ALIEN_STAPLE_TURRET,d,m)}for(var p=0;p<40;p++){var E=a.UNIVERSE_RADIUS+35500,f=150*p-3e3;Xr(a.SHIP_ALIEN_STAPLE_TURRET,E,f)}}function zr(){var e=window.world.system.spriteContainers.minimap,t=new window.PIXI.Container;e.addChild(t);var n=new window.PIXI.Graphics;n.drawRect(0,a.SCREEN_HEIGHT-a.MINIMAP_HEIGHT,a.MINIMAP_WIDTH,a.SCREEN_HEIGHT),n.renderable=!0,n.cacheAsBitmap=!0,t.addChild(n),t.mask=n;var r=new window.PIXI.Graphics;t.addChild(r),window.world.system.miniMapGraphics=r}function Zr(e){var t=e.data.global.x,n=e.data.global.y,r=window.world.system.screenScale,i=t/r,u=n/r;i<a.MINIMAP_WIDTH&&u>a.SCREEN_HEIGHT-a.MINIMAP_HEIGHT&&o.clickOnMinimap(i,u)}function $r(e){var t=window.world;t.system.gameState=e,e===a.GAME_STATE.FLY?(o.enterFlyState(),t.system.gameLoop=o.flyLoop):e===a.GAME_STATE.MANAGE?(u.enterManageState(),t.system.gameLoop=u.manageLoop):t.system.gameLoop=null}function ea(){var e,t=window.world,n=Object(Rr.a)(t.planets);try{for(n.s();!(e=n.n()).done;){var r,i=e.value,o=Object(Rr.a)(i.buildings);try{for(o.s();!(r=o.n()).done;){r.value.type===a.BUILDING_TYPE_MINE&&(ta(i,"titanium",a.MINE_SPEED_TITANIUM),ta(i,"gold",a.MINE_SPEED_GOLD),ta(i,"uranium",a.MINE_SPEED_URANIUM))}}catch(d){o.e(d)}finally{o.f()}if(0===i.resources.raw.titanium&&0===i.resources.raw.gold&&0===i.resources.raw.uranium){var u,s=Wr(i),l=Object(Rr.a)(s.children);try{for(l.s();!(u=l.n()).done;){var c=u.value;c.animationSpeed&&(c.animationSpeed=0)}}catch(d){l.e(d)}finally{l.f()}}}}catch(d){n.e(d)}finally{n.f()}}function ta(e,t,n){e.resources.raw[t]>0&&(e.resources.raw[t]-=n,e.resources.stored[t]+=n,e.resources.raw[t]<=0&&(e.resources.raw[t]=0),function(e,t){var n=window.world.blueprints,r=n.xp[t.spriteFile]+=e,a=n.xpLevels[t.spriteFile][0];a&&a.xp<=r&&(ra(a),n.xpLevels[t.spriteFile].shift())}(n,e))}function na(e){var t=window.world.blueprints,n=t.xp[e.name];if(n?n+=1:n=1,t.xp[e.name]=n,t.xpLevels[e.name]){var r=t.xpLevels[e.name][0];r&&r.xp<=n&&(ra(r),t.xpLevels[e.name].shift())}}function ra(e){r.showToast("New plan: "+e.obj.name);var t=window.world.blueprints;e.obj.objType===a.OBJ_EQUIP?t.equip.push(e.obj):e.obj.objType===a.OBJ_SHIP?t.ship.push(e.obj):console.warn("Could not find blueprint of type "+e.obj.objType+" nextLevel=",e)}function aa(e,t,n){var r=0,a=0,i=0;return e&&(r+=e.resources.stored.titanium,a+=e.resources.stored.gold,i+=e.resources.stored.uranium),t&&(r+=t.resources.titanium,a+=t.resources.gold,i+=t.resources.uranium),r>=n.titanium&&a>=n.gold&&i>=n.uranium}function ia(e,t,n){oa(e,t,"titanium",n.titanium),oa(e,t,"gold",n.gold),oa(e,t,"uranium",n.uranium)}function oa(e,t,n,r){var a=-r;if(e){if((a=e.resources.stored[n]-r)>=0)return void(e.resources.stored[n]-=r);e.resources.stored[n]=0}t?(t.resources[n]=t.resources[n]+a,t.resources[n]<0&&console.warn("Ship is in debt "+t.resources[n]+" "+n)):a<0&&(e.resources.stored[n]=e.resources.stored[n]+a,console.warn("Planet is in debt "+e.resources.stored[n]+" "+n))}function ua(){window.world.system.explosionSheet=window.PIXI.Loader.shared.resources[a.CRASH_JSON].spritesheet,sa()}function sa(){var e=new window.PIXI.AnimatedSprite(window.world.system.explosionSheet.animations[a.CRASH]);return e.animationSpeed=.4,e.loop=!1,e.anchor.set(.5,.5),e.scale.set(2,2),e.x=a.HALF_SCREEN_WIDTH,e.y=a.HALF_SCREEN_WIDTH,e.loop=!0,e.visible=!1,window.world.system.explosions.push(e),window.world.system.spriteContainers.explosions.addChild(e),e}function la(){console.log("Take off")}function ca(e){e>1.005&&console.log("Lagging with delta="+e);var t=window.world,n=window.world.ship;if(da(),n.alive){ha(n);var o=t.system.buttonKeyDown;(t.system.keys.left.isDown||t.system.keys.a.isDown||o.left)&&Ma(n,!0),(t.system.keys.right.isDown||t.system.keys.d.isDown||o.right)&&Ma(n,!1),(t.system.keys.up.isDown||t.system.keys.w.isDown||o.up)&&function(e){var t,n=e.propulsion,r=Object(Rr.a)(e.equip);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.type===a.EQUIP_TYPE_SPEED&&i.boostSpeed&&(n+=i.boostSpeed)}}catch(o){r.e(o)}finally{r.f()}e.vx+=n*Math.cos(e.rotation),e.vy+=n*Math.sin(e.rotation)}(n),(t.system.keys.down.isDown||t.system.keys.s.isDown||o.down)&&function(e){var t=Qa(e,a.EQUIP_TYPE_BRAKE);t&&(t.brakeSpeedPct>0?(e.vx-=e.vx*t.brakeSpeedPct,e.vy-=e.vy*t.brakeSpeedPct):(e.vx=0,e.vy=0))}(n),t.system.keys.c.isUp&&!t.system.continuousFireUp&&(t.system.continuousFireUp=!0),t.system.keys.c.isDown&&t.system.continuousFireUp&&(t.system.continuousFire=!t.system.continuousFire,t.system.continuousFireUp=!1),(t.system.keys.space.isDown||t.system.continuousFire||o.space)&&Ha(n,.05),(t.system.keys.x.isDown||o.x)&&Ca(n),t.system.keys.q.isDown&&La(n,!0),t.system.keys.e.isDown&&La(n,!1);var u,s=[],l=Object(Rr.a)(t.system.nearby.planets);try{for(l.s();!(u=l.n()).done;){var c=u.value;Ia(n,c)&&s.push(c)}}catch(g){l.e(g)}finally{l.f()}if(!!!Qa(n,a.EQUIP_TYPE_GRAVITY_SHIELD)){var d,m=Object(Rr.a)(s);try{for(m.s();!(d=m.n()).done;){var p=d.value,E=r.calcGravity(n.x,n.y,p);n.vx+=E.x,n.vy+=E.y}}catch(g){m.e(g)}finally{m.f()}}n.x+=n.vx,n.y+=n.vy,t.view.x=n.x,t.view.y=n.y;var f=i.getShipSprite(n);if(f.rotation=n.rotation,!t.system.initializing){var h,w=Object(Rr.a)(s);try{for(w.s();!(h=w.n()).done;){var y=h.value;if(Aa(n,f,y))return void xa(n,y)}}catch(g){w.e(g)}finally{w.f()}var I,_=Object(Rr.a)(t.system.nearby.ships);try{for(_.s();!(I=_.n()).done;){var S=I.value;S.alive&&Ta(n,f,S)&&qa(n,S)}}catch(g){_.e(g)}finally{_.f()}}}!function(){var e,t=window.world.ship,n=Object(Rr.a)(window.world.system.explosions);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.x=r.globalX-t.x+a.HALF_SCREEN_WIDTH,r.y=r.globalY-t.y+a.HALF_SCREEN_HEIGHT}}catch(g){n.e(g)}finally{n.f()}}(),ya(n),Ka(),t.system.initializing&&(t.system.initializing=!1)}function da(){var e=window.world.system.nearby,t=window.world.ship,n=t.x-a.NEARBY_WIDTH/2,r=t.x+a.NEARBY_WIDTH/2,i=t.y-a.NEARBY_HEIGHT/2,o=t.y+a.NEARBY_HEIGHT/2;e.planets=[];var u,s=Object(Rr.a)(window.world.planets);try{for(s.s();!(u=s.n()).done;){var l=u.value;l.x+l.radius>=n&&l.x-l.radius<=r&&l.y+l.radius>=i&&l.y-l.radius<=o&&e.planets.push(l)}}catch(p){s.e(p)}finally{s.f()}e.ships=[window.world.ship];var c,d=Object(Rr.a)(window.world.ships);try{for(d.s();!(c=d.n()).done;){var m=c.value;m.x+m.radius>=n&&m.x-m.radius<=r&&m.y+m.radius>=i&&m.y-m.radius<=o&&e.ships.push(m)}}catch(p){d.e(p)}finally{d.f()}}function ma(){var e,t=window.world.ship,n=Object(Rr.a)(window.world.planets);try{for(n.s();!(e=n.n()).done;){Ia(t,e.value)}}catch(u){n.e(u)}finally{n.f()}var r,a=Object(Rr.a)(window.world.ships);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.spriteId&&(i.getShipSprite(o).visible=!1,o.spriteId=null)}}catch(u){a.e(u)}finally{a.f()}da(),s.moveAliens(),Ka()}function pa(){var e,t=Object(Rr.a)(window.world.system.nearby.ships);try{for(t.s();!(e=t.n()).done;){Ea(e.value)}}catch(n){t.e(n)}finally{t.f()}}function Ea(e){var t,n=Object(Rr.a)(e.equip);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.cool&&(r.cool-=1),r.weapon&&r.weapon.cool&&(r.weapon.cool-=1),r.shield&&r.shield.active&&(r.shield.lifetime-=1,r.shield.lifetime<=0&&(r.shield.lifetime=0,ja(e,r.shield)))}}catch(a){n.e(a)}finally{n.f()}}function fa(e){var t,n=Object(Rr.a)(e.equip);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.type===a.EQUIP_TYPE_PRIMARY_WEAPON&&r.cool>0&&(r.cool=0)}}catch(i){n.e(i)}finally{n.f()}}function ha(e){var t,n=Object(Rr.a)(e.equip);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.type===a.EQUIP_TYPE_REPAIR_DROID&&e.armor<e.armorMax){var o={titanium:0,gold:0,uranium:0};i.canAfford(null,e,o)&&(e.armor+=r.repairSpeed,i.payResourceCost(null,e,o))}else r.type===a.EQUIP_TYPE_GUNNERY_DROID&&wa(e,r.weapon)}}catch(u){n.e(u)}finally{n.f()}}function wa(e,t){if(!(t.cool>0)){var n,i=null,o=null,u=Object(Rr.a)(window.world.system.nearby.ships);try{for(u.s();!(n=u.n()).done;){var s=n.value;if(s.alive&&s.owner===a.ALIEN){var l=r.distanceBetween(e.x,e.y,s.x,s.y);(!i||l<o)&&(i=s,o=l)}}}catch(d){u.e(d)}finally{u.f()}if(i&&o<=Ja(t)){var c=e.rotation;e.rotation=r.normalizeRadian(Math.atan2(i.y-e.y,i.x-e.x)),Oa(t,e,.1),e.rotation=c}}}function ya(e){var t=window.world.system.bgSprite;t.tilePosition.x=100-e.x+a.HALF_SCREEN_WIDTH,t.tilePosition.y=100-e.y+a.HALF_SCREEN_HEIGHT}function Ia(e,t){if(e.x+a.HALF_SCREEN_WIDTH+t.radius<t.x||e.x-a.HALF_SCREEN_WIDTH-t.radius>t.x||e.y+a.HALF_SCREEN_HEIGHT+t.radius<t.y||e.y-a.HALF_SCREEN_HEIGHT-t.radius>t.y){if(t.spriteId){var n=i.getPlanetSprite(t);n.visible&&(n.visible=!1)}return!1}var r=i.getPlanetSprite(t);return r.visible=!0,r.x=t.x-e.x+a.HALF_SCREEN_WIDTH,r.y=t.y-e.y+a.HALF_SCREEN_HEIGHT,!0}function _a(e){var t,n=Object(Rr.a)(e.equip);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.shield&&r.shield.active)return r.shield}}catch(a){n.e(a)}finally{n.f()}return null}function Sa(e){var t,n=Object(Rr.a)(e.equip);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.shield&&!r.shield.active&&0===r.cool)return r}}catch(a){n.e(a)}finally{n.f()}return null}function ga(e){var t,n=Object(Rr.a)(e.equip);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.type===a.EQUIP_TYPE_SHIELD_DROID)return r}}catch(i){n.e(i)}finally{n.f()}return null}function va(e){var t,n=null,r=Object(Rr.a)(e.equip);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.shield&&(n=a,a.shield.active))return n}}catch(i){r.e(i)}finally{r.f()}return n}function Aa(e,t,n){var i=_a(e);if(i)return r.distanceBetween(e.x,e.y,n.x,n.y)<n.radius+i.radius;var o,u=r.getVertexData(e.x,e.y,t),s=Object(Rr.a)(u);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(r.distanceBetween(l[0],l[1],n.x,n.y)<n.radius-a.ALLOWED_OVERLAP)return!0}}catch(c){s.e(c)}finally{s.f()}return!1}function Ta(e,t,n){if(e===n)return!1;var i=_a(e);if(i)return r.distanceBetween(e.x,e.y,n.x,n.y)<n.radius+i.radius;var o,u=r.getVertexData(e.x,e.y,t),s=Object(Rr.a)(u);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(n.radius)if(r.distanceBetween(l[0],l[1],n.x,n.y)<n.radius-a.ALLOWED_OVERLAP)return!0}}catch(c){s.e(c)}finally{s.f()}return!1}function xa(e,t){window.world.system.continuousFire=!1;var n=r.normalizeRadian(Math.atan2(e.y-t.y,e.x-t.x));if(t.spriteFile===a.WORMHOLE_SPRITE){var o=T(n,200),u=o.xAmt,s=o.yAmt,l=T(n+Math.PI/2,5),c=l.xAmt,d=l.yAmt;return e.x=t.jumpToX+u,e.y=t.jumpToY+s,e.vx=c,e.vy=d,void ma()}var m=Math.abs(e.rotation-n),p=Math.abs(e.vx)+Math.abs(e.vy),E=(m<e.crashAngle||m>2*Math.PI-e.crashAngle)&&p<e.crashSpeed,f=!!Qa(e,a.EQUIP_TYPE_AUTOLANDER);if(e.vx=0,e.vy=0,!E&&!f){var h=Math.max(p-e.crashSpeed,0),w=Math.max(m-e.crashAngle,0);w>Math.PI&&(w=2*Math.PI-m-e.crashAngle),Ya(e,(h/3+w)*e.armorMax,Na,!0)}var y=_a(e);if(y&&ja(e,y),e.armor>0){window.world.selectedPlanet=t,window.world.lastPlanetLanded=t;var I=r.directionTo(t.x,t.y,e.x,e.y),_=t.radius+e.spriteWidth/2,S=r.dirComponents(I,_),g=S.xAmt,v=S.yAmt;e.x=t.x+g,e.y=t.y+v,e.rotation=I,t.lastLandingDir=I,i.getShipSprite(e).rotation=I,ma(),i.changeGameState(a.GAME_STATE.MANAGE)}}function ba(e){var t,n=null,r=Object(Rr.a)(window.world.system.explosions);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(!o.visible){n=o;break}}}catch(s){r.e(s)}finally{r.f()}n||(n=i.createExplosionSprite());var u=window.world.ship;return n.visible=!0,n.globalX=e.x,n.globalY=e.y,n.x=e.x-u.x+a.HALF_SCREEN_WIDTH,n.y=e.y-u.y+a.HALF_SCREEN_HEIGHT,n}function Pa(e){var t=ba(e);t.scale.set(6,6),t.play();var n,r=Object(Rr.a)(window.world.system.nearby.ships);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.alive&&i.id!==e.id&&i.name!==a.SHIP_BOMB.name){var o=_(i.x,i.y,e.x,e.y);o<=300&&Ya(i,300-o,null,!0)}}}catch(u){r.e(u)}finally{r.f()}t.onLoop=function(){t.stop(),t.visible=!1,t.scale.set(2,2)}}function Ra(e,t){var n=_a(e);n&&ja(e,n),e.owner===a.ALIEN&&i.addAlienXp(e);var r=ba(e);e.name===a.SHIP_BOMB.name&&Pa(e),i.getShipSprite(e).visible=!1,e.alive=!1,e.spriteId=null,r.play(),r.onLoop=function(){r.stop(),r.visible=!1,t&&t()}}function Na(){var e=window.world.ship,t=window.world.selectedPlanet;if(e.resourcesMax=0,e.resources={titanium:0,gold:0,uranium:0},e.equip=[],e.armorMax=0,e.armor=0,window.world.system.continuousFire=!1,!t||0===t.buildings.length){var n,r=Object(Rr.a)(window.world.planets);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.buildings.length>0){window.world.selectedPlanet=o;break}}}catch(m){r.e(m)}finally{r.f()}t||(window.world.selectedPlanet=window.world.planets[0])}var s=u.getAvailablePlanetXY(t,e,t.lastLandingDir,20,0),l=s.x,c=s.y,d=s.rotation;e.x=l,e.y=c,e.vx=0,e.vy=0,e.rotation=d,ma(),i.changeGameState(a.GAME_STATE.MANAGE)}function Ma(e,t){var n,i=e.turnSpeed,o=Object(Rr.a)(e.equip);try{for(o.s();!(n=o.n()).done;){var u=n.value;u.type===a.EQUIP_TYPE_TURN&&u.boostSpeed&&(i+=u.boostSpeed)}}catch(s){o.e(s)}finally{o.f()}e.rotation=r.normalizeRadian(e.rotation+i*(t?-1:1))}function La(e,t){var n=Qa(e,a.EQUIP_TYPE_THRUSTER);if(n){var i=r.normalizeRadian(e.rotation+(t?-1:1)*Math.PI/2),o=n.thrustSpeed*Math.cos(i),u=n.thrustSpeed*Math.sin(i);n.thrustType===a.THRUST_MOMENTUM?(e.vx+=o,e.vy+=u):n.thrustType===a.THRUST_BLINK?(e.x+=o,e.y+=u):console.warn("Unable to use thruster with type "+n.thrustType)}}function Oa(e,t,n){e&&e.cool<=0&&(Ua(t,e,n),e.cool=e.coolTime)}function Ha(e,t){var n=Qa(e,a.EQUIP_TYPE_PRIMARY_WEAPON);n&&Oa(n,e,n.jitter?n.jitter:t)}function Da(e){if(!e.selectedSecondaryWeaponIndex||e.selectedSecondaryWeaponIndex<0)return Qa(e,a.EQUIP_TYPE_SECONDARY_WEAPON);var t=e.equip[e.selectedSecondaryWeaponIndex];return t.type!==a.EQUIP_TYPE_SECONDARY_WEAPON?(u.selectFirstSecondaryWeapon(e),Qa(e,a.EQUIP_TYPE_SECONDARY_WEAPON)):t}function Ca(e){var t=Da(e);if(t&&t.cool<=0){if(t.createShip){if(!i.canAfford(null,e,t.createShip.type.cost))return;i.payResourceCost(null,e,t.createShip.type.cost);var n=i.createShip(t.createShip.type,e.owner),o=i.getShipSprite(n),u=(e.spriteWidth||2*e.radius)/2+n.spriteWidth/2+20,l=t.createShip.dir===a.DIR_AHEAD_OF_SHIP?r.normalizeRadian(e.rotation-Math.PI):e.rotation,c=r.dirComponents(l,u),d=c.xAmt,m=c.yAmt;n.x=e.x-d,n.y=e.y-m,n.propulsion&&(n.vx=e.vx,n.vy=e.vy),n.rotation=r.normalizeRadian(l-Math.PI),o.x=n.x-window.world.ship.x+a.HALF_SCREEN_WIDTH,o.y=n.y-window.world.ship.y+a.HALF_SCREEN_HEIGHT,o.visible=!0,window.world.ships.push(n),s.checkForCollisionWithPlanet(n),s.checkForCollisionWithShip(n)}if(t.shield){if(null!==_a(e))return;Fa(e,t.shield)}t.cool=t.coolTime}}function Fa(e,t){null===_a(e)?(i.getShieldSprite(e,t).visible=!0,t.active=!0,t.lifetime=t.lifetimeMax,t.armor=t.armorMax,e.spriteWidth=2*t.radius,e.spriteHeight=2*t.radius):console.log("not enabling shield, as there is already one enabled")}function ja(e,t){i.getShieldSprite(e,t).visible=!1,t.active=!1;var n=i.getShipSprite(e);e.spriteWidth=n.width,e.spriteHeight=n.height}function Ua(e,t,n){var i=function(e){var t,n=Object(Rr.a)(window.world.system.bullets);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!r.active&&r.fileName===e)return r.active=!0,r.sprite.visible=!0,r}}catch(s){n.e(s)}finally{n.f()}var i={active:!0,damage:0,x:0,y:0,vx:0,vy:0,lifetime:1,fileName:e},o=window.PIXI.loader.resources[a.SPRITESHEET_JSON],u=new window.PIXI.Sprite(o.textures[e]);return u.x=-100,u.y=-100,u.anchor.set(.5,.5),u.scale.set(.5,.5),window.world.system.spriteContainers.bullets.addChild(u),i.sprite=u,window.world.system.bullets.push(i),i}(t.bulletFile);i.lifetime=t.lifetime,i.damage=t.damage;var o=n?n*Math.random()*(r.randomBool()?-1:1):0,u=e.rotation+o;i.vx=e.vx+t.speed*Math.cos(u),i.vy=e.vy+t.speed*Math.sin(u),i.x=e.x+Math.sqrt(e.spriteWidth*e.spriteWidth+e.spriteHeight*e.spriteHeight)/2*Math.cos(u),i.y=e.y+Math.sqrt(e.spriteWidth*e.spriteWidth+e.spriteHeight*e.spriteHeight)/2*Math.sin(u)}function Ga(e){e.active=!1,e.sprite.visible=!1,e.sprite.x=-100,e.sprite.y=-100,e.vx=0,e.vy=0}function ka(){var e,t=window.world.ship,n=Object(Rr.a)(window.world.system.bullets);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.active&&(r.x=r.x+r.vx,r.y=r.y+r.vy,r.sprite.x=r.x-t.x+a.HALF_SCREEN_WIDTH,r.sprite.y=r.y-t.y+a.HALF_SCREEN_HEIGHT,r.lifetime=r.lifetime-1,r.lifetime<=0&&Ga(r),Wa(r))}}catch(i){n.e(i)}finally{n.f()}}function Wa(e){var t,n=window.world.ship,o=Object(Rr.a)(window.world.system.nearby.planets);try{for(o.s();!(t=o.n()).done;){var u=t.value;r.distanceBetween(u.x,u.y,e.x,e.y)<u.radius&&Ga(e)}}catch(h){o.e(h)}finally{o.f()}if(n.alive&&e.x<n.x+(n.radius+10)&&e.x>n.x-(n.radius+10)&&e.y<n.y+(n.radius+10)&&e.y>n.y-(n.radius+10)){var s=i.getShipSprite(n),l=r.pointInSprite(n.x,n.y,s,e.x,e.y),c=_a(n);if(!c&&ga(n)&&window.world.system.gameState===a.GAME_STATE.FLY){var d=Sa(n);d&&l&&(d.cool=d.coolTime,Fa(n,d.shield),c=d.shield)}(c&&r.distanceBetween(n.x,n.y,e.x,e.y)<c.radius||l)&&Ba(e,n,Na)}var m,p=Object(Rr.a)(window.world.system.nearby.ships);try{for(p.s();!(m=p.n()).done;){var E=m.value;if(E!==n&&E.alive&&E.radius&&e.x<E.x+(E.radius+10)&&e.x>E.x-(E.radius+10)&&e.y<E.y+(E.radius+10)&&e.y>E.y-(E.radius+10)){var f=_a(E);(f&&r.distanceBetween(E.x,E.y,e.x,e.y)<f.radius||r.distanceBetween(E.x,E.y,e.x,e.y)<=E.radius)&&Ba(e,E,null)}}}catch(h){p.e(h)}finally{p.f()}}function Ba(e,t,n){Ya(t,e.damage,n,!0),Ga(e)}function Ya(e,t,n,r){var a=_a(e);r&&a?(a.armor-=t,a.armor<=0&&(a.armor=0,ja(e,a))):(e.armor=e.armor-t,e.armor<=0&&(e.armor=0,Ra(e,n)))}function qa(e,t){if(e!==t){var n=e.armor,r=t.armor;Ya(t,n,window.world.ship===t?Na:null,!1),Ya(e,r,window.world.ship===e?Na:null,!1),e.alive||(e.vx=0,e.vy=0)}}function Qa(e,t){var n,r=Object(Rr.a)(e.equip);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.type===t)return a}}catch(i){r.e(i)}finally{r.f()}return null}function Ka(){var e=window.world.system.miniMapGraphics,t=window.world.view,n=a.SCREEN_HEIGHT-a.MINIMAP_HEIGHT,r=a.MINIMAP_WIDTH,i=a.SCREEN_HEIGHT;e.clear(),e.beginFill(a.MINIMAP_BACKGROUND_COLOR),e.lineStyle(1,a.MINIMAP_BORDER_COLOR),e.drawRect(0,n,r,i),e.endFill();var o,u=Object(Rr.a)(window.world.planets);try{for(u.s();!(o=u.n()).done;){var s=o.value;if(Va(t,s)){var l=0+a.HALF_MINIMAP_WIDTH+(s.x-t.x)*a.MINIMAP_SCALE_X,c=n+a.HALF_MINIMAP_HEIGHT+(s.y-t.y)*a.MINIMAP_SCALE_Y,d=window.world.selectedPlanet===s?a.MINIMAP_SELECTED_PLANET_COLOR:a.PLANET_COLORS[s.spriteFile];e.lineStyle(2,d),e.beginFill(d),e.drawCircle(l,c,s.radius*a.MINIMAP_SCALE_X),e.endFill();var m,p=Object(Rr.a)(s.buildings);try{for(p.s();!(m=p.n()).done;){var E=m.value,f=0+a.HALF_MINIMAP_WIDTH+(E.x-t.x)*a.MINIMAP_SCALE_X-1.5,h=n+a.HALF_MINIMAP_HEIGHT+(E.y-t.y)*a.MINIMAP_SCALE_Y-1.5;e.lineStyle(1,a.MINIMAP_BUILDING_COLOR),e.drawRect(f,h,2,2)}}catch(I){p.e(I)}finally{p.f()}}}}catch(I){u.e(I)}finally{u.f()}var w=0+a.HALF_MINIMAP_WIDTH+(window.world.ship.x-t.x)*a.MINIMAP_SCALE_X,y=n+a.HALF_MINIMAP_HEIGHT+(window.world.ship.y-t.y)*a.MINIMAP_SCALE_Y;e.lineStyle(1,a.MINIMAP_SHIP_COLOR),e.beginFill(a.MINIMAP_SHIP_COLOR),e.drawCircle(w,y,2),e.endFill()}function Xa(e,t){if(window.world.system.gameState===a.GAME_STATE.MANAGE){var n,i=window.world.view,o=i.x+(e-a.HALF_MINIMAP_WIDTH)*(1/a.MINIMAP_SCALE_X),u=i.y+(t-(a.SCREEN_HEIGHT-a.MINIMAP_HEIGHT)-a.HALF_MINIMAP_HEIGHT)*(1/a.MINIMAP_SCALE_X),s=Object(Rr.a)(window.world.planets);try{for(s.s();!(n=s.n()).done;){var l=n.value;r.distanceBetween(o,u,l.x,l.y)<=l.radius&&(window.world.selectedPlanet=l)}}catch(c){s.e(c)}finally{s.f()}i.x=o,i.y=u,Ka()}}function Va(e,t){return!(e.x+a.HALF_MINIMAP_VIEW_WIDTH+t.radius<t.x||e.x-a.HALF_MINIMAP_VIEW_WIDTH-t.radius>t.x||e.y+a.HALF_MINIMAP_VIEW_HEIGHT+t.radius<t.y||e.y-a.HALF_MINIMAP_VIEW_HEIGHT-t.radius>t.y)}function Ja(e){return e?e.speed*e.lifetime*1.4:0}function za(e){return Ja(Qa(e,a.EQUIP_TYPE_PRIMARY_WEAPON))}function Za(){console.log("enter manage state")}function $a(e){(window.world.system.keys.up.isDown||window.world.system.keys.w.isDown)&&window.world.ship.alive&&!window.world.system.isTyping&&ei()}function ei(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=window.world,n=t.ship;i.changeGameState(a.GAME_STATE.FLY);var o=r.calcGravity(n.x,n.y,t.selectedPlanet);n.vx=o.x*-a.TAKEOFF_SPEED*e,n.vy=o.y*-a.TAKEOFF_SPEED*e}function ti(e){return e===a.BUILDING_TYPE_FACTORY?{spriteScale:a.FACTORY_SCALE,spriteFile:a.FACTORY_FILE,animation:!1}:e===a.BUILDING_TYPE_MINE?{spriteScale:a.MINE_SCALE,spriteFile:a.MINE_FILE,animation:!0}:(console.warn("Unknown building type ",e),{})}function ni(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=ti(e.type),u=o.spriteScale,s=o.spriteFile,l=o.animation,c=window.PIXI.Loader.shared.resources[a.SPRITESHEET_JSON].spritesheet;l?((n=new window.PIXI.AnimatedSprite(c.animations[s])).animationSpeed=a.MINE_ANIMATION_SPEED,n.play()):n=new window.PIXI.Sprite(c.textures[s]),n.anchor.set(.5,.5),n.scale.set(u,u),n.rotation=e.rotation,n.x=e.x-t.x,n.y=e.y-t.y,n.visible=!0,r||(r=i.getPlanetSprite(t)),r.addChild(n)}function ri(){var e=window.world,t={type:a.BUILDING_TYPE_MINE},n=e.selectedPlanet,r=e.ship;if(aa(n,r,a.MINE_COST)){var u=ii(n,r,ai(r,n,a.MINE_WIDTH),a.MINE_WIDTH,0),s=u.x,l=u.y,c=u.rotation;null!==s?(t.width=a.MINE_WIDTH,t.x=s,t.y=l,t.rotation=c,ni(t,n),i.payResourceCost(n,r,a.MINE_COST),n.buildings.push(t),o.drawMiniMap()):console.warn("Unable to place mine")}else console.log("Not enough resources to build a mine")}function ai(e,t,n){var a=e.rotation+Math.PI/2,i=e.x+n*Math.cos(a),o=e.y+n*Math.sin(a);return r.normalizeRadian(Math.atan2(o-t.y,i-t.x))}function ii(e,t,n,r,i){return oi(e,t,n,r)?{x:e.x+(e.radius+10)*Math.cos(n),y:e.y+(e.radius+10)*Math.sin(n),rotation:n}:i>2*Math.PI/a.BUILDING_PLACEMENT_ROTATION_INCREMENT?{x:null,y:null,rotation:null}:ii(e,t,n+a.BUILDING_PLACEMENT_ROTATION_INCREMENT,r,++i)}function oi(e,t,n,a){var i,o=e.x+(e.radius+10)*Math.cos(n),u=e.y+(e.radius+10)*Math.sin(n),s=r.distanceBetween(o,u,t.x,t.y),l=a,c=Object(Rr.a)(e.buildings);try{for(c.s();!(i=c.n()).done;){var d=i.value,m=r.distanceBetween(o,u,d.x,d.y);m<s&&(s=m,l=d.width)}}catch(p){c.e(p)}finally{c.f()}return s>a/2+l/2+15}function ui(e,t,n,r,a){var i=Number(r);i<0&&(i=0),isNaN(i)&&(i=0);var o=i;if((""===r||e[n]-i<0)&&(o=e[n]),null!==a){var u=a-(t.titanium+t.gold+t.uranium);u<o&&(o=u)}t[n]+=o,e[n]-=o}function si(e,t){ui(e.resources,t.resources.stored,"titanium",e.resources.titanium,null),ui(e.resources,t.resources.stored,"gold",e.resources.gold,null),ui(e.resources,t.resources.stored,"uranium",e.resources.uranium,null)}function li(e,t){var n=Math.floor(e.resourcesMax/3),r=e.resourcesMax-(e.resources.titanium+e.resources.gold+e.resources.uranium);if(!(r<=0)){var a=n>=20?n:20;e.resources.titanium<a&&ui(t.resources.stored,e.resources,"titanium",a-e.resources.titanium,e.resourcesMax),e.resources.gold<n&&ui(t.resources.stored,e.resources,"gold",n-e.resources.gold,e.resourcesMax),r=e.resourcesMax-(e.resources.titanium+e.resources.gold+e.resources.uranium),e.resources.uranium<r&&ui(t.resources.stored,e.resources,"uranium",r,e.resourcesMax),(r=e.resourcesMax-(e.resources.titanium+e.resources.gold+e.resources.uranium))>0&&(ui(t.resources.stored,e.resources,"titanium","",e.resourcesMax),ui(t.resources.stored,e.resources,"gold","",e.resourcesMax),ui(t.resources.stored,e.resources,"uranium","",e.resourcesMax))}}function ci(){var e=window.world,t=e.selectedPlanet,n=e.ship,r={type:a.BUILDING_TYPE_FACTORY};if(aa(t,n,a.FACTORY_COST)){var u=ii(t,n,ai(n,t,a.FACTORY_WIDTH),a.FACTORY_WIDTH,0),s=u.x,l=u.y,c=u.rotation;null!==s?(r.width=a.MINE_WIDTH,r.x=s,r.y=l,r.rotation=c,t.buildings.push(r),ni(r,t),i.payResourceCost(t,n,a.FACTORY_COST),o.drawMiniMap()):console.warn("Unable to place factory")}else console.log("Not enough resources to build a factory")}function di(e){var t=window.world.selectedPlanet,n=window.world.ship;if(aa(t,n,e.cost))if(ia(t,n,e.cost),e.autonomousShip)yi(e);else{var r=i.createShip(e,a.PLAYER);t.ships.push(r)}}function mi(e){var t=window.world.ship,n=window.world.selectedPlanet,r=window.world.lastPlanetLanded;if(pi(e,n)){if(Ei(t,r),window.world.ship=e,t&&t.alive&&t.spriteId)o.resetWeaponsCool(t),i.getShipSprite(t).visible=!1,t.spriteId=null;var u=i.getShipSprite(e);u.visible=!0,e.rotation=n.lastLandingDir,u.rotation=e.rotation,u.position.set(a.HALF_SCREEN_WIDTH,a.HALF_SCREEN_HEIGHT);var s=n.radius+e.spriteWidth/2;e.x=n.x+s*Math.cos(e.rotation),e.y=n.y+s*Math.sin(e.rotation),window.world.lastPlanetLanded=n,o.repositionScreen()}else console.warn("Unable to remove ship from planet ",e," planet=",n)}function pi(e,t){var n=t.ships.filter((function(t){return t!==e})),r=n.length<t.ships.length;return t.ships=n,r}function Ei(e,t){e.alive&&e.armorMax>0&&t.ships.push(e)}function fi(e){var t,n=Object(Rr.a)(e.buildings);try{for(n.s();!(t=n.n()).done;){if(t.value.type===a.BUILDING_TYPE_FACTORY)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}function hi(e){var t=Lr.a.cloneDeep(e);return t.id=window.world.nextId++,t}function wi(e){var t=window.world.selectedPlanet,n=window.world.ship;aa(t,n,e.cost)&&(ia(t,n,e.cost),t.equip.push(hi(e)))}function yi(e){var t=window.world.selectedPlanet,n=window.world.ship,o=i.createShip(e,n.owner),u=i.getShipSprite(o),l=t.radius+o.spriteWidth+10;o.aiData={homePlanet:t,targetPlanet:null},o.x=t.x,o.y=t.y,u.x=o.x-window.world.ship.x+a.HALF_SCREEN_WIDTH,u.y=o.y-window.world.ship.y+a.HALF_SCREEN_HEIGHT,u.visible=!0,window.world.ships.push(o),o.aiData.targetPlanet=s.getTargetPlanetWithResources(o);var c=null;c=o.aiData.targetPlanet?r.directionTo(o.aiData.targetPlanet.x,o.aiData.targetPlanet.y,t.x,t.y):n.rotation+Math.PI/2;var d=r.dirComponents(c,l),m=d.xAmt,p=d.yAmt;o.x=t.x-m,o.y=t.y-p,o.rotation=r.normalizeRadian(c-Math.PI)}function Ii(e){return{titanium:(e.armorMax-e.armor)/5,gold:0,uranium:0}}function _i(e,t){var n=Ii(e),r=e.armorMax-e.armor;if(!i.canAfford(t,e,n)){var a=t.resources.stored.titanium+e.resources.titanium;n.titanium=a,r=5*a}i.payResourceCost(t,e,n),e.armor+=r}function Si(e,t){t.type===a.EQUIP_TYPE_ARMOR?(e.armor===e.armorMax&&(e.armor+=t.armorAmt),e.armorMax+=t.armorAmt):t.type===a.EQUIP_TYPE_STORAGE&&(e.resourcesMax+=t.storageAmount)}function gi(e){for(var t=0;t<e.equip.length;t++)if(e.equip[t].type===a.EQUIP_TYPE_SECONDARY_WEAPON)return void(e.selectedSecondaryWeaponIndex=t);e.selectedSecondaryWeaponIndex=-1}function vi(e,t,n){e.equip.push(n),Si(e,n),Lr.a.remove(t.equip,(function(e){return e.id===n.id})),gi(e)}function Ai(e,t,n){if(t.equip.push(n),n.type===a.EQUIP_TYPE_ARMOR)e.armorMax-=n.armorAmt,e.armor>e.armorMax&&(e.armor=e.armorMax);else if(n.type===a.EQUIP_TYPE_STORAGE){e.resourcesMax-=n.storageAmount;var r=e.resources.titanium+e.resources.gold+e.resources.uranium;if(r>e.resourcesMax){var i=this.removeResource(e,"titanium",r-e.resourcesMax);i>0&&(i=this.removeResource(e,"gold",i)),i>0&&(i=this.removeResource(e,"uranium",i)),i>0&&console.warn("Cannot remove more resources from ship still owing "+i)}}Lr.a.remove(e.equip,(function(e){return e.id===n.id})),gi(e)}function Ti(e,t){e.resources.stored.titanium+=t.cost.titanium*a.SALVAGE_RATE,e.resources.stored.gold+=t.cost.gold*a.SALVAGE_RATE,e.resources.stored.uranium+=t.cost.uranium*a.SALVAGE_RATE,Lr.a.remove(e.equip,(function(e){return e.id===t.id}))}function xi(e,t){var n,r=Object(Rr.a)(t.equip);try{for(r.s();!(n=r.n()).done;){Ti(e,n.value)}}catch(o){r.e(o)}finally{r.f()}(e.resources.stored.titanium+=t.cost.titanium*a.SALVAGE_RATE,e.resources.stored.gold+=t.cost.gold*a.SALVAGE_RATE,e.resources.stored.uranium+=t.cost.uranium*a.SALVAGE_RATE,pi(t,e),t===window.world.ship)&&(i.getShipSprite(t).visible=!1,t.alive=!1,t.spriteId=null)}function bi(e,t,n){if(e.resources[t]-=n,e.resources[t]<0){var r=Math.abs(e.resources[t]);return e.resources[t]=0,r}return 0}function Pi(e,t){return!!(e&&e.equip&&t)&&(!(e.equip.length>=e.equipMax)&&(![Dt,Ct,jt].includes(t.type)||!e.equip.find((function(e){return e.type===t.type}))))}function Ri(){var e,t=window.world.ship,n=Object(Rr.a)(window.world.system.nearby.ships);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.alive&&t!==r){var o=!1;if(r.aiType===a.ALIEN_AI_CREEPER?o=Qi(r,!1):r.aiType===a.ALIEN_AI_KAMIKAZI?o=Qi(r,!0):r.aiType===a.EQUIP_AI_TURRET?o=Mi(r,.7):r.aiType===a.ALIEN_AI_TURRET?o=Mi(r,.25):r.aiType===a.EQUIP_AI_MISSILE?o=ki(r):r.aiType===a.ALIEN_AI_MOTHERSHIP?Li(r):r.aiType===a.EQUIP_AI_RESOURCE_DROID&&(o=Oi(r)),o&&(Ji(r),zi(r)),t.x+a.HALF_SCREEN_WIDTH+r.radius>=r.x&&t.x-a.HALF_SCREEN_WIDTH-r.radius<=r.x&&t.y+a.HALF_SCREEN_HEIGHT+r.radius>=r.y&&t.y-a.HALF_SCREEN_HEIGHT-r.radius<=r.y){if(r.alive){var u=i.getShipSprite(r);u.visible=!0,u.rotation=r.rotation,u.x=r.x-t.x+a.HALF_SCREEN_WIDTH,u.y=r.y-t.y+a.HALF_SCREEN_HEIGHT}}else if(r.spriteId)i.getShipSprite(r).visible=!1,r.spriteId=null}}}catch(s){n.e(s)}finally{n.f()}}function Ni(e,t,n,a){e.rotation=r.normalizeRadian(Math.atan2(n-e.y,t-e.x)),o.firePrimaryWeapon(e,a)}function Mi(e,t){var n=Ui(e),r=n.target,a=n.dist;return!(!r||!r.alive)&&(a<o.primaryWeaponRange(e)&&Ni(e,r.x,r.y,t),!1)}function Li(e){var t=window.world.ship;if(t.alive){var n=r.distanceBetween(e.x,e.y,t.x,t.y);n<o.primaryWeaponRange(e)&&Ni(e,t.x,t.y,.3),n<3*a.SCREEN_WIDTH&&o.fireSecondaryWeapon(e),e.armor<e.armorMax&&Zi(e)}}function Oi(e){e.aiData.targetPlanet||(e.aiData.targetPlanet=ji(e));var t=e.aiData.targetPlanet;if(!t)return!0;if(e.aiData.stuckCounter>500){for(var n=ji(e),a=0;n===e.aiData.targetPlanet&&a<100;)n=ji(e),a++;e.aiData.targetPlanet=n}var i=r.directionTo(e.x,e.y,t.x,t.y);e.rotation=i;var o=Bi(e,t.x,t.y,!1),u=o.xAmt,s=o.yAmt;return u&&s?(e.x+=u,e.y+=s,e.aiData.stuckCounter=0):e.aiData.stuckCounter++,r.distanceBetween(e.x,e.y,t.x,t.y)<=t.radius+e.radius+15&&(t.id===e.aiData.homePlanet.id?Hi(e,t):Di(e,t)),!0}function Hi(e,t){u.transferResource(e.resources,t.resources.stored,"titanium",e.resources.titanium,null),u.transferResource(e.resources,t.resources.stored,"gold",e.resources.gold,null),u.transferResource(e.resources,t.resources.stored,"uranium",e.resources.uranium,null),e.aiData.targetPlanet=ji(e)}function Di(e,t){var n=e.resourcesMax/3;u.transferResource(t.resources.stored,e.resources,"titanium",n,e.resourcesMax),u.transferResource(t.resources.stored,e.resources,"gold",n,e.resourcesMax),u.transferResource(t.resources.stored,e.resources,"uranium",n,e.resourcesMax),e.resourcesMax>e.resources.titanium+e.resources.gold+e.resources.uranium&&(u.transferResource(t.resources.stored,e.resources,"titanium",e.resourcesMax,e.resourcesMax),u.transferResource(t.resources.stored,e.resources,"gold",e.resourcesMax,e.resourcesMax),u.transferResource(t.resources.stored,e.resources,"uranium",e.resourcesMax,e.resourcesMax)),e.aiData.targetPlanet=e.aiData.homePlanet}function Ci(){var e,t=Object(Rr.a)(window.world.ships);try{for(t.s();!(e=t.n()).done;){if(e.value.aiType===a.EQUIP_AI_RESOURCE_DROID)return!0}}catch(n){t.e(n)}finally{t.f()}return!1}function Fi(){var e,t=window.world.selectedPlanet,n=0,r=Object(Rr.a)(window.world.ships);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.aiType===a.EQUIP_AI_RESOURCE_DROID&&i.alive&&(i.aiData.homePlanet=t,i.aiData.targetPlanet=t,n++)}}catch(o){r.e(o)}finally{r.f()}C(n+" droids summoned")}function ji(e){var t,n=[],a=e.aiData.homePlanet.id,i=Object(Rr.a)(window.world.planets);try{for(i.s();!(t=i.n()).done;){var o=t.value,u=o.resources.stored,s=u.titanium+u.gold+u.uranium;if(s>1&&a!==o.id){var l=r.distanceBetween(o.x,o.y,e.x,e.y);n.push({planet:o,dist:l,totalResources:s})}}}catch(S){i.e(S)}finally{i.f()}n.sort((function(e,t){return e.dist-t.dist}));for(var c=n.length?n[0].dist:0,d=0,m=n;d<m.length;d++){var p=m[d],E=1/(p.dist/c)*2*Math.min(p.totalResources/(3*e.resourcesMax),1)*100;p.score=E}var f,h=n.sort((function(e,t){return t.score-e.score})).slice(0,10),w=h.reduce((function(e,t){return e+t.score}),0),y=r.randomInt(0,w),I=Object(Rr.a)(h);try{for(I.s();!(f=I.n()).done;){var _=f.value;if(_.score>=y)return _.planet;y-=_.score}}catch(S){I.e(S)}finally{I.f()}return console.warn("Could not find any planet to collect resources from"),null}function Ui(e){return e.owner===a.PLAYER?Ki(e.x,e.y,e.id):Xi(e.x,e.y,e.id)}function Gi(e){return e.owner===a.PLAYER?Xi(e.x,e.y,e.id):Ki(e.x,e.y,e.id)}function ki(e){var t=Ui(e),n=t.target,i=t.dist;if(n&&i<a.SCREEN_WIDTH){var o=r.directionTo(e.x,e.y,n.x,n.y),u=r.dirComponents(o,e.propulsion),s=u.xAmt,l=u.yAmt;return e.vx+=s,e.vy+=l,e.x+=e.vx,e.y+=e.vy,e.armor<e.armorMax&&Zi(e),!0}return!1}function Wi(e,t,n,a,i,o){var u=r.directionTo(e,t,a,i),s=u-o,l=s>=0?-1:1;Math.abs(s)>Math.PI&&(l*=-1);var c=u+l*Math.PI/2,d=r.dirComponents(c,20*n);return{xAmt:d.xAmt,yAmt:d.yAmt}}function Bi(e,t,n,a){if(e&&e.alive){var i,o=r.directionTo(e.x,e.y,t,n),u=r.dirComponents(o,25*e.propulsion),s=u.xAmt,l=u.yAmt,c=Object(Rr.a)(window.world.planets);try{for(c.s();!(i=c.n()).done;){var d=i.value;if(r.distanceBetween(e.x+s,e.y+l,d.x,d.y)<d.radius+e.radius+10){var m=Wi(e.x,e.y,e.propulsion,d.x,d.y,o);qi(e.x+m.xAmt,e.y+m.yAmt,e.radius)?(s=0,l=0):(s=m.xAmt,l=m.yAmt)}}}catch(f){c.e(f)}finally{c.f()}var p=a?Gi(e):Vi(e.x+s,e.y+l,e.id);if(p.target&&p.dist<=p.target.radius+e.radius+20){var E=Wi(e.x,e.y,e.propulsion,p.target.x,p.target.y,o);Yi(e.x+E.xAmt,e.y+E.yAmt,e.id,e.radius)?(s=0,l=0):(s=E.xAmt,l=E.yAmt)}return{xAmt:s,yAmt:l}}}function Yi(e,t,n,a){var i,o=Object(Rr.a)(window.world.ships);try{for(o.s();!(i=o.n()).done;){var u=i.value;if(u.alive&&u.id!==n)if(r.distanceBetween(u.x,u.y,e,t)<=u.radius+a)return!0}}catch(s){o.e(s)}finally{o.f()}return!1}function qi(e,t,n){var a,i=Object(Rr.a)(window.world.planets);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(r.distanceBetween(o.x,o.y,e,t)<=o.radius+n)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}function Qi(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.world.ship;if(n.alive){var i=e.viewRange||a.SCREEN_WIDTH,u=!1,s=Ui(e),l=s.target,c=s.dist;if(l){if(c<i){var d=r.directionTo(e.x,e.y,l.x,l.y),m=Bi(e,l.x,l.y,t),p=m.xAmt,E=m.yAmt;!t&&c<n.spriteWidth+e.radius+20&&(p=0,E=0);var f=Gi(e),h=f.target;h&&r.distanceBetween(e.x+p,e.y+E,h.x,h.y)<e.radius+h.radius+10&&(p=0,E=0),e.armor<e.armorMax&&Zi(e),e.x+=p,e.y+=E,e.rotation=d,u=!0}return c<o.primaryWeaponRange(e)&&Ni(e,l.x,l.y,.15),u}}}function Ki(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none",o=null,u=null,s=Object(Rr.a)(window.world.system.nearby.ships);try{for(s.s();!(n=s.n()).done;){var l=n.value;if(l.alive&&l.owner===a.ALIEN&&l.id!==i){var c=r.distanceBetween(e,t,l.x,l.y);(!o||c<u)&&(o=l,u=c)}}}catch(d){s.e(d)}finally{s.f()}return{target:o,dist:u}}function Xi(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none",o=window.world.ship,u=o,s=o.id!==i?r.distanceBetween(e,t,o.x,o.y):99999999999,l=Object(Rr.a)(window.world.system.nearby.ships);try{for(l.s();!(n=l.n()).done;){var c=n.value;if(c.alive&&c.owner===a.PLAYER&&c.id!==i){var d=r.distanceBetween(e,t,c.x,c.y);(!u||d<s)&&(u=c,s=d)}}}catch(m){l.e(m)}finally{l.f()}return{target:u,dist:s}}function Vi(e,t,n){for(var a=99999999999,i=null,o=0,u=[].concat(Object(Nr.a)(window.world.ships),[window.world.ship]);o<u.length;o++){var s=u[o];if(s.alive&&s.id!==n){var l=r.distanceBetween(e,t,s.x,s.y);(!i||l<a)&&(i=s,a=l)}}return{target:i,dist:a}}function Ji(e){var t,n=Object(Rr.a)(window.world.system.nearby.planets);try{for(n.s();!(t=n.n()).done;){var a=t.value;r.distanceBetween(e.x,e.y,a.x,a.y)<=e.radius+a.radius&&o.destroyShip(e,null)}}catch(i){n.e(i)}finally{n.f()}}function zi(e){var t,n=Object(Rr.a)(window.world.system.nearby.ships);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.alive&&e!==i)r.distanceBetween(e.x,e.y,i.x,i.y)<=e.radius+i.radius&&(o.shipsCollide(e,i),e.name===a.SHIP_FRIENDSHIP_MISSILE.name&&i.owner!==e.owner&&(i.owner=e.owner))}}catch(u){n.e(u)}finally{n.f()}}function Zi(e){var t=$i(e);!t||t.cool>0||(o.enableShield(e,t.shield),t.cool=t.coolTime)}function $i(e){for(var t=0;t<e.equip.length;t++){var n=e.equip[t];if(n.type===a.EQUIP_TYPE_SECONDARY_WEAPON&&n.shield)return n}return null}function eo(e,t){localStorage.getItem(e)&&localStorage.removeItem(e),localStorage.setItem(e,JSON.stringify(t))}function to(e){if(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null}console.warn("Unable to from localStorage without a key")}function no(e){var t=e.target.result;e.oldVersion>=1&&t.deleteObjectStore("world"),t.createObjectStore("world",{keyPath:"saveGameName"})}function ro(e){var t=indexedDB.open("astrominer",1);t.onerror=function(e){console.log("error ",e)},t.onupgradeneeded=no,t.onsuccess=function(t){var n=t.target.result.transaction(["world"]).objectStore("world").get(e);n.onerror=function(e){console.log("Request error loading:",e)},n.onsuccess=function(e){var t=n.result,a=window.world.system;window.world=t,window.world.system=a,window.world.system.spriteContainers.planets.removeChildren(),window.world.system.planetSpriteCache={},window.world.system.spriteContainers.ships.removeChildren(),window.world.system.shipSpriteCache={},window.world.system.shieldSpriteCache=new Map,window.world.system.bullets=[],window.world.system.spriteContainers.bullets.removeChildren(),window.world.system.explosions=[],window.world.system.spriteContainers.explosions.removeChildren(),window.world.ship.spriteId=null,i.getShipSprite(window.world.ship).visible=window.world.ship.alive,o.repositionScreen(),r.showToast("Loaded game")}}}function ao(e){var t=Lr.a.cloneDeep(Lr.a.omit(window.world,["system"]));t.saveGameName=e;var n=indexedDB.open("astrominer",1);n.onerror=function(e){console.log("DB Request Error:",e)},n.onupgradeneeded=no,n.onsuccess=function(e){var n=e.target.result.transaction(["world"],"readwrite").objectStore("world").put(t);n.onsuccess=function(e){r.showToast("Saved game")},n.onerror=function(e){console.log("failed to save ",e.target)}}}function io(e){var t=indexedDB.open("astrominer",1);t.onerror=function(e){console.log("DB Request Error:",e)},t.onupgradeneeded=no,t.onsuccess=function(t){var n=t.target.result.transaction(["world"],"readwrite").objectStore("world").delete(e);n.onsuccess=function(t){r.showToast("Deleted game "+e)},n.onerror=function(e){console.log("failed to delete ",e.target)}}}n(39),n(40),n(41);var oo="heatbar-green.png",uo="heatbar-red.png",so="heatbar-color.png";function lo(e){var t=e.type,n=e.curr,r=e.max;if(t!==oo&&t!==uo&&t!==so)return console.warn("unknown heatbar type "+t),d.a.createElement("span",null);var a=100-100*(n/r),i="images/"+(t===uo?uo:oo);return t===so&&a>60&&(i="images/heatbar-color.png"),d.a.createElement("span",{className:"heatbar-container",style:{width:"24px",height:"100px"}},d.a.createElement("span",{className:"heatbar-base"},d.a.createElement("img",{src:"images/heatbar-base.png",width:"24px",height:"100px",alt:"heat"})),d.a.createElement("span",{className:"heatbar-color"},d.a.createElement("img",{src:i,width:"24px",height:"100px",alt:"heat",style:{clipPath:"inset("+a+"px 0px 00px 0px)"}})))}n(42);function co(e){var t=e.selected,n=e.onChange,r=t?"images/button_push_on.png":"images/button_push_off.png";return d.a.createElement("img",{src:r,width:"44px",height:"26px",alt:"button",onClick:function(){n()}})}n(43);var mo="button_long_green.png",po="button_long_red.png",Eo="button_long_yellow.png",fo="button_long_black.png";function ho(e){var t=function(e,t){return!t||t<=0?{rightFree:0,colorImgSrc:"images/"+fo}:e>=t?{rightFree:0,colorImgSrc:"images/"+mo}:e/t<.7?{rightFree:48-(5+38*(e/(.7*t))),colorImgSrc:"images/"+po}:{rightFree:48-(5+38*((e-.7*t)/(t*(1-.7)))),colorImgSrc:"images/"+Eo}}(e.curr,e.max),n=t.rightFree,r=t.colorImgSrc;return d.a.createElement("span",{className:"statusbutton-container",style:{width:"48px",height:"24px"}},d.a.createElement("span",{className:"statusbutton-base"},d.a.createElement("img",{src:"images/"+fo,width:"48px",height:"24px",alt:"status"})),d.a.createElement("span",{className:"statusbutton-color"},d.a.createElement("img",{src:r,width:"48px",height:"24px",alt:"heat",style:{clipPath:"inset(0px "+n+"px 0px 0px)"}})))}function wo(){var e=window.world.ship,t=o.getEquippedShield(e);function n(e){window.world.system.buttonKeyDown[e]=!0}function r(e){window.world.system.buttonKeyDown[e]=!1}function i(e){return e.preventDefault(),e.stopPropagation(),!1}return d.a.createElement("div",{className:"section",style:{backgroundImage:'url("images/metalbackground.png")',backgroundSize:"cover",height:"100%",paddingLeft:"3px"}},d.a.createElement("div",{className:"top-row"},d.a.createElement("div",null,d.a.createElement("div",null,e.name),d.a.createElement("table",null,d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",{style:{paddingRight:"10px"}},"Armor"),d.a.createElement("th",null,"Shield"))),d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",{style:{textAlign:"center"}},d.a.createElement(lo,{type:so,curr:e.armor,max:e.armorMax})),d.a.createElement("td",null,t&&t.shield.active&&d.a.createElement("span",null,d.a.createElement(lo,{type:uo,curr:t.shield.lifetime,max:t.shield.lifetimeMax}),d.a.createElement(lo,{type:so,curr:t.shield.armor,max:t.shield.armorMax})))),d.a.createElement("tr",null,d.a.createElement("td",null,Math.floor(e.armor)," / ",e.armorMax),d.a.createElement("td",null," "),d.a.createElement("td",null," "))))),d.a.createElement("div",{className:"bluescreen-container"},d.a.createElement("div",{className:"bluescreen-background"},d.a.createElement("img",{src:"images/blue_screen.png",className:"stretch",alt:"bluescreen"})),d.a.createElement("div",{className:"bluescreen-text"},d.a.createElement("table",{cellPadding:"4"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",{colSpan:"100%"},"Resources"))),d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,"Titatium"),d.a.createElement("td",null,Math.floor(e.resources.titanium))),d.a.createElement("tr",null,d.a.createElement("td",null,"Gold"),d.a.createElement("td",null,Math.floor(e.resources.gold))),d.a.createElement("tr",null,d.a.createElement("td",null,"Uranium"),d.a.createElement("td",null,Math.floor(e.resources.uranium)))))))),d.a.createElement("table",null,d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("div",null,d.a.createElement("b",null,"Equip (max ",e.equipMax,")")),d.a.createElement("table",null,d.a.createElement("tbody",null,e.equip.map((function(t,n){return d.a.createElement("tr",{key:n,className:"equip"},d.a.createElement("td",null,t.type===a.EQUIP_TYPE_SECONDARY_WEAPON&&d.a.createElement(co,{selected:n===e.selectedSecondaryWeaponIndex,onChange:function(){e.selectedSecondaryWeaponIndex=n}})),d.a.createElement("td",null,d.a.createElement(ho,{curr:t.coolTime-t.cool,max:t.coolTime})),d.a.createElement("td",null,t.name))}))))),d.a.createElement("td",{style:{paddingLeft:"10px"}}," ")))),d.a.createElement("div",{className:"button-control-container"},d.a.createElement("div",{className:"button-space"},d.a.createElement("button",{type:"button",onMouseDown:function(){return n("x")},onMouseUp:function(){return r("x")},onTouchStart:function(){return n("x")},onTouchEnd:function(){return r("x")},onContextMenu:function(e){return i(e)}},d.a.createElement("b",null,"X"))),d.a.createElement("div",{className:"button-space"},d.a.createElement("button",{type:"button",onMouseDown:function(){return n("space")},onMouseUp:function(){return r("space")},onTouchStart:function(){return n("space")},onTouchEnd:function(){return r("space")},onContextMenu:function(e){return i(e)}},d.a.createElement("i",{className:"fa fa-crosshairs"}," "))),d.a.createElement("table",null,d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null," "),d.a.createElement("td",null,d.a.createElement("button",{type:"button",onMouseDown:function(){return n("up")},onMouseUp:function(){return r("up")},onTouchStart:function(){return n("up")},onTouchEnd:function(){return r("up")},onContextMenu:function(e){return i(e)}},d.a.createElement("i",{className:"fa fa-arrow-up"}," "))),d.a.createElement("td",null," ")),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("button",{type:"button",onMouseDown:function(){return n("left")},onMouseUp:function(){return r("left")},onTouchStart:function(){return n("left")},onTouchEnd:function(){return r("left")},onContextMenu:function(e){return i(e)}},d.a.createElement("i",{className:"fa fa-arrow-left"}," "))),d.a.createElement("td",null,d.a.createElement("button",{type:"button",onMouseDown:function(){return n("down")},onMouseUp:function(){return r("down")},onTouchStart:function(){return n("down")},onTouchEnd:function(){return r("down")},onContextMenu:function(e){return i(e)}},d.a.createElement("i",{className:"fa fa-arrow-down"}," "))),d.a.createElement("td",null,d.a.createElement("button",{type:"button",onMouseDown:function(){return n("right")},onMouseUp:function(){return r("right")},onTouchStart:function(){return n("right")},onTouchEnd:function(){return r("right")},onContextMenu:function(e){return i(e)}},d.a.createElement("i",{className:"fa fa-arrow-right"}," "))))))),d.a.createElement("div",{className:"intro-dialog",onClick:function(){window.world.introDialogShown=!0},style:{display:window.world.introDialogShown?"none":"block"}},d.a.createElement("span",{className:"close-intro-dialog"},"X"),d.a.createElement("p",null,"Ship's Log: Day 348"),d.a.createElement("p",null," After a long trip through deep space, I have finally made it to the edge of the asteroid field that until now I wasn't certain actually existed. We will see if it lives up to the rumors from old men in taverns of asteroids full of titanium, gold and uranium, a place where a man can make a fortune mining.  So it really does exist, but where are all the other people who came to make their fortune? This place looks empty."),d.a.createElement("p",null,"It took years to save up enough to get this Explorer-class spaceship, and I outfitted it with a state-of-the-art AI which can build autonomous mines to extract resources. It can also create fully automated factories to produce ships and equipment. The AI can learn new patterns for the factories to build by being exposed to various different environments and equipment.  I have heard a lot about the power of this AI and can't wait to try it out."),d.a.createElement("p",null,"The first step is to find a planet with a good amount of resources and build a mine. I will have to be careful landing the ship though, as the ship must be going slow enough and land on it's landing gear or it will be damaged."),d.a.createElement("p",null," Use the arrow keys or W-A-S-D keys to move the ship, and the spacebar to shoot. X will deploy a secondary weapon.")))}n(44),n(45);function yo(){var e=Object(c.useState)(""),t=Object(Pr.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)(""),l=Object(Pr.a)(o,2),m=l[0],p=l[1],E=Object(c.useState)(""),f=Object(Pr.a)(E,2),h=f[0],w=f[1],y=window.world,I=window.world.selectedPlanet,_=window.world.ship,S=I===window.world.lastPlanetLanded&&_.alive;return d.a.createElement("div",{className:"planet-info"},d.a.createElement("div",{className:"section"},d.a.createElement("b",null,"Planet Name: ")," ",y.selectedPlanet.name),d.a.createElement("div",{className:"build-button"},d.a.createElement("button",{disabled:!i.canAfford(I,S?_:null,a.MINE_COST),onClick:function(){return u.buildMine()}},"Build Mine"),"Cost: T:",a.MINE_COST.titanium," G:",a.MINE_COST.gold),d.a.createElement("div",{className:"build-button"},d.a.createElement("button",{disabled:!i.canAfford(I,S?_:null,a.FACTORY_COST),onClick:function(){return u.buildFactory()}},"Build Factory"),"Cost: T:",a.FACTORY_COST.titanium," G:",a.FACTORY_COST.gold," U:",a.FACTORY_COST.uranium),d.a.createElement("div",{style:{display:_.alive?"block":"none"}},d.a.createElement("div",{className:"section"},d.a.createElement("b",null,"Ship")," (",Math.round(_.armor)+" / "+_.armorMax,") "),d.a.createElement("div",{className:"section"},d.a.createElement("button",{style:{marginLeft:"10px"},onClick:function(){return u.unloadShip(_,I)}},"Unload"),d.a.createElement("button",{style:{marginLeft:"10px"},onClick:function(){return u.resupplyShip(_,I)}},"Resupply"),d.a.createElement("button",{style:{marginLeft:"10px"},onClick:function(){return u.repairShip(_,I)},disabled:_.armorMax<=_.armor},"Repair"))),d.a.createElement("div",{className:"section"},d.a.createElement("div",{className:"section"},d.a.createElement("b",null,"Resources")),d.a.createElement("div",{className:"row-item"},"Titanium ",Math.floor(I.resources.raw.titanium)),d.a.createElement("div",{className:"row-item"},"Gold ",Math.floor(I.resources.raw.gold)),d.a.createElement("div",{className:"row-item"},"Uranium ",Math.floor(I.resources.raw.uranium))),S&&d.a.createElement("table",{className:"row-item resource-table"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,"Resource"),d.a.createElement("th",null,"Planet"),d.a.createElement("th",null,"Transfer"),d.a.createElement("th",null,"Ship (",_.resourcesMax,")"))),d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,"Titanium"),d.a.createElement("td",null,Math.floor(I.resources.stored.titanium)),d.a.createElement("td",null,d.a.createElement("span",{className:"transfer-button",onClick:function(){return u.transferResource(_.resources,I.resources.stored,"titanium",n,a.PLANET_RESOURCE_MAX)}},d.a.createElement("i",{className:"fa fa-arrow-left"}," ")),d.a.createElement("input",{type:"text",className:"transfer-input",defaultValue:n,onChange:function(e){return r(e.target.value)}}),d.a.createElement("span",{className:"transfer-button",onClick:function(){return u.transferResource(I.resources.stored,_.resources,"titanium",n,_.resourcesMax)}},d.a.createElement("i",{className:"fa fa-arrow-right"}," "))),d.a.createElement("td",null,Math.floor(_.resources.titanium))),d.a.createElement("tr",null,d.a.createElement("td",null,"Gold"),d.a.createElement("td",null,Math.floor(I.resources.stored.gold)),d.a.createElement("td",null,d.a.createElement("span",{className:"transfer-button",onClick:function(){return u.transferResource(_.resources,I.resources.stored,"gold",m,a.PLANET_RESOURCE_MAX)}},d.a.createElement("i",{className:"fa fa-arrow-left"}," ")),d.a.createElement("input",{type:"text",className:"transfer-input",defaultValue:m,onChange:function(e){return p(e.target.value)}}),d.a.createElement("span",{className:"transfer-button",onClick:function(){return u.transferResource(I.resources.stored,_.resources,"gold",m,_.resourcesMax)}},d.a.createElement("i",{className:"fa fa-arrow-right"}," "))),d.a.createElement("td",null,Math.floor(_.resources.gold))),d.a.createElement("tr",null,d.a.createElement("td",null,"Uranium"),d.a.createElement("td",null,Math.floor(I.resources.stored.uranium)),d.a.createElement("td",null,d.a.createElement("span",{className:"transfer-button",onClick:function(){return u.transferResource(_.resources,I.resources.stored,"uranium",h,a.PLANET_RESOURCE_MAX)}},d.a.createElement("i",{className:"fa fa-arrow-left"}," ")),d.a.createElement("input",{type:"text",className:"transfer-input",defaultValue:h,onChange:function(e){return w(e.target.value)}}),d.a.createElement("span",{className:"transfer-button",onClick:function(){return u.transferResource(I.resources.stored,_.resources,"uranium",h,_.resourcesMax)}},d.a.createElement("i",{className:"fa fa-arrow-right"}," "))),d.a.createElement("td",null,Math.floor(_.resources.uranium))))),!S&&d.a.createElement("table",null,d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,"Resource"),d.a.createElement("th",null,"Planet"))),d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,"Titanium"),d.a.createElement("td",null,Math.floor(I.resources.stored.titanium))),d.a.createElement("tr",null,d.a.createElement("td",null,"Gold"),d.a.createElement("td",null,Math.floor(I.resources.stored.gold))),d.a.createElement("tr",null,d.a.createElement("td",null,"Uranium"),d.a.createElement("td",null,Math.floor(I.resources.stored.uranium))))),d.a.createElement("div",{style:{marginTop:"20px",marginLeft:"5px"}},d.a.createElement("button",{disabled:!S,onClick:function(){return u.takeOff(5)}},"Take Off"),s.hasDroids()&&d.a.createElement("button",{onClick:function(){return s.summonAllDroids()},style:{marginLeft:"10px"}},"Summon all resource droids")))}n(46),n(47);var Io=n(65),_o=n(64);n(48),n(49);function So(e){var t=e.template,n=window.world,r=n.selectedPlanet,o=n.ship,s=t.objType===a.OBJ_SHIP?r.ships.filter((function(e){return e.name===t.name})).length:r.equip.filter((function(e){return e.name===t.name})).length,l=t.description;if(!l&&t.damage&&(l="".concat(Math.round(t.damage*(60/t.coolTime))," dmg/s Range ").concat(t.speed*t.lifetime," Speed ").concat(t.speed," ")),!l&&t.shield){var c=t.shield;l="".concat(c.armorMax,"dmg for ").concat(Math.round(c.lifetimeMax/60),"s every ").concat(Math.round(t.coolTime/60),"s")}if(t.createShip){var m=t.createShip.type;l+=" Cost (".concat(m.cost.titanium,"T ").concat(m.cost.gold,"G ").concat(m.cost.uranium,"U)")}return o.alive&&t.name===o.name&&(s+=1),d.a.createElement("tr",null,d.a.createElement("td",{className:"factory-row"},s),d.a.createElement("td",{className:"factory-row"},d.a.createElement("button",{className:"factory-button",disabled:!u.hasFactory(r)||!i.canAfford(r,o,t.cost),onClick:function(){var e;(e=t).objType===a.OBJ_SHIP?u.buildShip(e):e.objType===a.OBJ_EQUIP&&u.buildEquip(e)}},t.name)),d.a.createElement("td",{className:"factory-row"},d.a.createElement("span",{className:"cost"},t.cost.titanium,"T ",t.cost.gold,"G ",t.cost.uranium,"U")),d.a.createElement("td",{className:"factory-row"},l))}function go(e){var t=e.type,n=e.templateList;return d.a.createElement("div",{className:"container factory-tab",style:{maxHeight:a.SCREEN_HEIGHT-200,minWidth:"400px"}},d.a.createElement("table",null,d.a.createElement("tbody",null,n.map((function(e,n){return d.a.createElement(So,{key:t+n,template:e})})))))}function vo(){var e=window.world.blueprints.equip,t=e.filter((function(e){return a.EQUIP_UPGRADES.find((function(t){return t.name===e.name}))})),n=e.filter((function(e){return a.EQUIP_PRIMARY_WEAPONS.find((function(t){return t.name===e.name}))})),r=e.filter((function(e){return a.EQUIP_SECONDARY_WEAPONS.find((function(t){return t.name===e.name}))})),i=e.filter((function(e){return a.EQUIP_DROIDS.find((function(t){return t.name===e.name}))}));return d.a.createElement("div",{className:"factory-info"},d.a.createElement(Io.a,{defaultActiveKey:"ships",id:"factory-tabs",className:"flex-nowrap"},d.a.createElement(_o.a,{eventKey:"ships",title:"Ships"},d.a.createElement(go,{type:"ship",templateList:window.world.blueprints.ship})),t&&t.length>0&&d.a.createElement(_o.a,{eventKey:"upgrades",title:"Upgrades"},d.a.createElement(go,{type:"equip",templateList:t})),n&&n.length>0&&d.a.createElement(_o.a,{eventKey:"primaryWeapons",title:"Primary Weapons"},d.a.createElement(go,{type:"equip",templateList:n})),r&&r.length>0&&d.a.createElement(_o.a,{eventKey:"secondaryWeapons",title:"Secondary Weapons"},d.a.createElement(go,{type:"equip",templateList:r})),i&&i.length>0&&d.a.createElement(_o.a,{eventKey:"droids",title:"Droids"},d.a.createElement(go,{type:"equip",templateList:i}))))}n(57);function Ao(){var e=Object(c.useState)(),t=Object(Pr.a)(e,2),n=t[0],r=t[1],a=window.world,i=a.selectedPlanet,o=a.ship,s=i===window.world.lastPlanetLanded&&o.alive;!n&&s&&r(o);var l=[];if(n){var m,p=Object(Rr.a)(n.equip);try{var E=function(){var e=m.value;l.push(d.a.createElement("div",{className:"item",key:e.id},e.name," \xa0",d.a.createElement("button",{onClick:function(){return u.moveEquipFromShipToPlanet(n,i,e)}},"Remove")))};for(p.s();!(m=p.n()).done;)E()}catch(f){p.e(f)}finally{p.f()}}return d.a.createElement("div",null,d.a.createElement("div",{className:"storage-section"},d.a.createElement("div",{className:"title"},"Ships"),d.a.createElement("span",{className:"item-list"},(s?[o]:[]).concat(i.ships).map((function(e,t){return d.a.createElement("div",{key:t,onClick:function(){return function(e){r(e)}(e)},className:"ship ".concat(n===e?"selected-item":"non-selected-item")},e.name)}))),d.a.createElement("span",{className:"item-details"},null!=n&&d.a.createElement("div",null,d.a.createElement("div",{className:"item-attr"},d.a.createElement("button",{onClick:function(){return u.switchToShip(n),void r(null)},disabled:n===o},"Use Ship"),d.a.createElement("button",{onClick:function(){return function(e){window.confirm("Are you sure you want to salvage your "+e.name+"?")&&(u.salvageShip(i,e),r(null))}(n)},style:{marginLeft:"10px"}},"Salvage")),d.a.createElement("div",{className:"item-attr"},d.a.createElement("b",null,"Name")," ",n.name," ",n.id),d.a.createElement("div",{className:"item-attr"},d.a.createElement("b",null,"Engine")," Propulsion:",Math.floor(100*n.propulsion)," Turn:",Math.floor(100*n.turnSpeed)),d.a.createElement("div",{className:"item-attr"},d.a.createElement("b",null,"Landing")," Speed:",Math.floor(n.crashSpeed)," Angle:",Math.floor(10*n.crashAngle)),d.a.createElement("div",{className:"item-attr"},d.a.createElement("b",null,"Armor")," \xa0",Math.floor(n.armor)," of ",Math.floor(n.armorMax),"\xa0",d.a.createElement("button",{onClick:function(){return u.repairShip(n,i)},disabled:n.armorMax<=n.armor}," Repair"),"\xa0 Cost ",Math.floor(u.costToRepair(n).titanium)," titanium"),d.a.createElement("div",{className:"item-attr"},d.a.createElement("b",null,"Resources Max"),Math.floor(n.resourcesMax)),d.a.createElement("div",{className:"item-attr"},d.a.createElement("b",null,"Equip")," (",n.equip.length," of ",n.equipMax,")",l)))),d.a.createElement("div",{className:"storage-section"},d.a.createElement("div",{className:"title"},"Equipment"),d.a.createElement("span",{className:"equip-list"},i.equip.map((function(e,t){return d.a.createElement("div",{key:t,className:"item"},e.name," \xa0",d.a.createElement("button",{onClick:function(){return u.moveEquipFromPlanetToShip(n,i,e)},disabled:!u.canEquip(n,e)},"Equip"),d.a.createElement("button",{onClick:function(){return function(e){window.confirm("Are you sure you want to this "+e.name+"?")&&u.salvageEquip(i,e)}(e)},style:{marginLeft:"10px"}},"Salvage"))})))))}n(58);function To(){var e=window.world,t=Object(c.useRef)(),n=l.loadLocalStorage(a.LOCALSTORAGE_GAME_NAMES_KEY);function r(n){t.current.value=n,e.saveGameName=n,console.log("new name "+n)}function i(e){e&&!n.includes(e)&&n.push(e),l.saveLocalStorage(a.LOCALSTORAGE_GAME_NAMES_KEY,n)}return n||(n=[],i(null)),d.a.createElement("div",{style:{paddingLeft:"10px"}},d.a.createElement("div",{className:"system-section"},d.a.createElement("div",{className:"section"},d.a.createElement("b",null,"Current Game")),d.a.createElement("input",{type:"text",defaultValue:e.saveGameName,onFocus:function(){return e.system.isTyping=!0},onBlur:function(){return e.system.isTyping=!1},ref:t}),d.a.createElement("button",{name:"Save",onClick:function(){return function(){var e=t.current.value;e?(l.saveWorld(e),i(e),r(e)):C("Cannot save game without name")}()}},"Save"),d.a.createElement("div",{className:"section"},d.a.createElement("b",null,"Saved Game")),n.map((function(i){return d.a.createElement("div",{key:i,className:"game-list-row "+(e.saveGameName===i?"selected-game":"")},d.a.createElement("span",{className:"game-list-item"},d.a.createElement("button",{onClick:function(){return function(e){l.loadWorld(e),r(e)}(i)}},"Load ")),d.a.createElement("span",{className:"game-list-item"},d.a.createElement("button",{onClick:function(){return function(r){window.confirm("Are you sure you want to delete "+r+"?")&&(l.deleteWorld(r),n=Lr.a.remove(n,(function(e){return e!==r})),l.saveLocalStorage(a.LOCALSTORAGE_GAME_NAMES_KEY,n),e.saveGameName===r&&(e.saveGameName=null),t.current.value===r&&(t.current.value=""))}(i)}},"Delete")),d.a.createElement("span",{className:"game-list-item"},i))}))),d.a.createElement("div",{style:{color:"#909090"}},"Version ",e.appVersion,e.appVersion!==a.APP_VERSION&&d.a.createElement("span",null," in ",a.APP_VERSION)))}n(59),n(60),n(61);function xo(){var e=Object(c.useState)(!1),t=Object(Pr.a)(e,2),n=t[0],r=t[1],a=window.world.selectedPlanet,i=window.world.ship,o=a===window.world.lastPlanetLanded&&i.alive&&100===(null===a||void 0===a?void 0:a.id),u=Object(c.useState)(""),s=Object(Pr.a)(u,2),l=s[0],m=s[1],p=Object(c.useState)(""),E=Object(Pr.a)(p,2),f=E[0],h=E[1],w=Object(c.useState)(""),y=Object(Pr.a)(w,2),I=y[0],_=y[1],S=Object(c.useState)(""),g=Object(Pr.a)(S,2),v=g[0],A=g[1],T=Object(c.useState)(""),x=Object(Pr.a)(T,2),b=x[0],P=x[1],R=Object(c.useState)(""),N=Object(Pr.a)(R,2),M=N[0],L=N[1],O="good"===v&&"good"===b&&"good"===M;return d.a.createElement(c.Fragment,null,o&&d.a.createElement("div",{className:"system-section code-section"},d.a.createElement("button",{type:"button",onClick:function(){return r(!0)}}," Enter Codes"),d.a.createElement("div",{className:"code-dialog",style:{display:n?"block":"none"}},d.a.createElement("span",{className:"close-code-dialog",onClick:function(){return r(!1)}},"X"),d.a.createElement("div",{className:"code-title code-center"},"Code Entry"),d.a.createElement("div",{className:"code-text"},"Enter the calculated values for codes you have found here."),d.a.createElement("div",{className:"code-input"},"The Steep",d.a.createElement("input",{type:"text",value:l,onChange:function(e){return m(e.target.value)}}),"good"===v&&d.a.createElement("span",{className:"code-good"},"GOOD"),"wrong"===v&&d.a.createElement("span",{className:"code-wrong"},"WRONG")),d.a.createElement("div",{className:"code-input"},"The Heap",d.a.createElement("input",{type:"text",value:f,onChange:function(e){return h(e.target.value)}}),"good"===b&&d.a.createElement("span",{className:"code-good"},"GOOD"),"wrong"===b&&d.a.createElement("span",{className:"code-wrong"},"WRONG")),d.a.createElement("div",{className:"code-input"},"The Deep",d.a.createElement("input",{type:"text",value:I,onChange:function(e){return _(e.target.value)}}),"good"===M&&d.a.createElement("span",{className:"code-good"},"GOOD"),"wrong"===M&&d.a.createElement("span",{className:"code-wrong"},"WRONG")),!O&&d.a.createElement("div",{className:"code-submit"},d.a.createElement("button",{type:"button",onClick:function(){return A("H2401"===l.toUpperCase()?"good":"wrong"),P("4194304"===f?"good":"wrong"),void L("2187"===I?"good":"wrong")}},"Check Codes")),O&&d.a.createElement("div",{className:"code-answer"},d.a.createElement("b",null,"Congratulations"),", you have found all the codes! ",d.a.createElement("br",null),"The treasure is almost yours.",d.a.createElement("br",null),"Go to the thinking rock at ",d.a.createElement("a",{href:"https://goo.gl/maps/Bkh6o5eDeKKaC7ey9"},"44.478953, -63.673837")," ",d.a.createElement("br",null),"The entrance is 30m east of the thinking rock at the bottom of the cliff.",d.a.createElement("br",null),"Once you go in the entrance follow the hallway until you get to the hard right turn and then look in the cellar.",d.a.createElement("br",null)))))}function bo(){var e,t=window.world.blueprints.xp,n=window.world.gameTickCount,r=Math.floor(n/360)/10,i=0;r>60&&(i=Math.floor(r/60),r=Math.floor(r-60*i));var o=(e={},Object(U.a)(e,a.PLANET_ROCK_FILE,"Rock Planet"),Object(U.a)(e,a.PLANET_RED_FILE,"Red Planet"),Object(U.a)(e,a.PLANET_GREEN_FILE,"Green Planet"),Object(U.a)(e,a.PLANET_PURPLE_FILE,"Purple Planet"),e);return d.a.createElement("div",null,d.a.createElement("div",{className:"system-section"},d.a.createElement("div",{className:"section"},d.a.createElement("b",null,"Experience Log")),d.a.createElement("div",null,d.a.createElement("table",{className:"log-table"},d.a.createElement("tbody",null,Object.entries(t).map((function(e){var t=Object(Pr.a)(e,2),n=t[0],r=t[1];return r?d.a.createElement("tr",{key:n},d.a.createElement("td",null,d.a.createElement("b",null,o[n]||n)),d.a.createElement("td",null,Math.round(r))):d.a.createElement("tr",{key:n})})))),d.a.createElement("div",{className:"tick-count"},"Total time spent : ",i?i+" hour"+(i>1?"s ":" "):""," ",r," min"))),d.a.createElement("div",{className:"system-section"},d.a.createElement("div",{className:"section"},d.a.createElement("b",null,"Keyboard Help")),d.a.createElement("div",{style:{paddingLeft:"10px"}},d.a.createElement("div",null,d.a.createElement("b",null,"Left / Right arrow keys")," to turn left and right"),d.a.createElement("div",null,d.a.createElement("b",null,"Up arrow")," to accelerate "),d.a.createElement("div",null,d.a.createElement("b",null,"Down arrow")," to brake"),d.a.createElement("div",null,d.a.createElement("b",null,"X")," to use the selected secondary weapon"),d.a.createElement("div",null,"You may use WASD instead of the arrow keys"),d.a.createElement("div",null,d.a.createElement("b",null,"C")," to engage/disengage continuous fire"))),d.a.createElement(xo,null))}function Po(){return d.a.createElement(Io.a,{defaultActiveKey:"planet",id:"manage-tabs",mountOnEnter:!0,unmountOnExit:!0,className:"flex-nowrap"},d.a.createElement(_o.a,{eventKey:"planet",title:"Planet"},d.a.createElement(yo,null)),d.a.createElement(_o.a,{eventKey:"factory",title:"Factory"},d.a.createElement(vo,null)),d.a.createElement(_o.a,{eventKey:"storage",title:"Storage"},d.a.createElement(Ao,null)),d.a.createElement(_o.a,{eventKey:"log",title:"Log"},d.a.createElement(bo,null)),d.a.createElement(_o.a,{eventKey:"system",title:"System"},d.a.createElement(To,null)))}var Ro=function(e){Object(h.a)(n,e);var t=Object(w.a)(n);function n(){return Object(E.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"render",value:function(){var e=window.world;return e.system.gameState===a.GAME_STATE.MANAGE?d.a.createElement(Po,null):e.system.gameState===a.GAME_STATE.FLY?d.a.createElement(wo,null):d.a.createElement("div",null,"...")}}]),n}(d.a.Component),No=function(e){Object(h.a)(n,e);var t=Object(w.a)(n);function n(e){var u;return Object(E.a)(this,n),(u=t.call(this,e)).createPixiApp=function(){var e=new window.PIXI.Application({width:a.SCREEN_WIDTH,height:a.SCREEN_HEIGHT});e.renderer.backgroundColor=a.BLACK,u.pixiRef.current.appendChild(e.view),window.PIXI.loader.add(a.SPRITESHEET_JSON).add(a.CRASH_JSON).add(a.SMOKE_JSON).add(a.STAR_BACKGROUND_FILE).load(u.setupGame),window.world.system.app=e},u.setupGame=function(){i.setupWorld(),u.setupKeyboardListeners(),u.setupWindowResizeListener(),i.changeGameState(a.GAME_STATE.FLY),window.world.system.app.renderer.plugins.interaction.on("pointerdown",(function(e){i.click(e)})),window.world.system.app.ticker.add((function(e){return u.mainLoop(e)}))},u.mainLoop=function(e){window.world.system.gameLoop&&(window.world.gameTickCount+=1,i.runBuildings(),o.moveBullets(),o.coolAllWeapons(),s.moveAliens(),window.world.system.gameLoop(e)),window.world.gameTickCount%15===0&&u.forceUpdate()},u.setupKeyboardListeners=function(){window.world.system.keys.left=r.keyboardListener("ArrowLeft"),window.world.system.keys.right=r.keyboardListener("ArrowRight"),window.world.system.keys.up=r.keyboardListener("ArrowUp"),window.world.system.keys.down=r.keyboardListener("ArrowDown"),window.world.system.keys.space=r.keyboardListener(" "),window.world.system.keys.w=r.keyboardListener("w"),window.world.system.keys.a=r.keyboardListener("a"),window.world.system.keys.s=r.keyboardListener("s"),window.world.system.keys.d=r.keyboardListener("d"),window.world.system.keys.q=r.keyboardListener("q"),window.world.system.keys.e=r.keyboardListener("e"),window.world.system.keys.x=r.keyboardListener("x"),window.world.system.keys.c=r.keyboardListener("c")},window.world=i.createEmptyWorld(),u.pixiRef=d.a.createRef(),u}return Object(f.a)(n,[{key:"componentDidMount",value:function(){this.createPixiApp()}},{key:"render",value:function(){return d.a.createElement("table",{className:"root-app",width:"100%"},d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("div",{className:"viewport",ref:this.pixiRef})),d.a.createElement("td",{className:"info-panel",width:"100%",height:(window.world.system.screenHeight||a.SCREEN_HEIGHT)+"px"},d.a.createElement("div",{className:"scroll-box"},d.a.createElement(Ro,null))))))}},{key:"setupWindowResizeListener",value:function(){window.addEventListener("resize",Mo),Mo()}}]),n}(d.a.Component);function Mo(){var e=window.world.system.app,t=window.innerHeight,n=window.innerWidth;n/t<1.8&&(t=n/1.8);var r=t/1e3;window.world.system.app.stage.scale.set(r),e.renderer.resize(t,t),window.world.system.screenHeight=t,window.world.system.screenWidth=n,window.world.system.screenScale=r;var a="14px";n<1300?a="12px":n<1e3&&(a="8px"),document.body.style.fontSize=a}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));p.a.render(d.a.createElement(No,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.e7915613.chunk.js.map